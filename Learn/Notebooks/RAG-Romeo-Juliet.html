<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>rag-romeo-juliet – Nexus: Crowdsourced ML Resources</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-04295ab5d254036c8b2bb88c9c9877ad.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>


</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../images/ML+X_Logo_Secondary_Transparent.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="https://github.com/UW-Madison-DataScience/ML-X-Nexus" title="GitHub organization" class="quarto-navigation-tool px-1" aria-label="GitHub organization"><i class="bi bi-github"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Learn/Guides/How-to-contribute.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to contribute?</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../Learn/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Learn</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Learn/Blogs/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Blogs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Learn/Books/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Books</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Learn/Guides/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Guides</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Learn/Workshops/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workshops</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Learn/Notebooks/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebooks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Learn/Videos/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Videos</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../Toolbox/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Toolbox</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Toolbox/Compute/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Compute</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Toolbox/Data/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Toolbox/GenAI/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GenAI</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Toolbox/Libraries/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Libraries</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Toolbox/Models/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Models</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../Applications/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Applications</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Applications/Blogs/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Blogs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Applications/EDA/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EDA</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../Applications/Videos/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Videos</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Applications/Videos/Exploring-AI-at-UW/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AI @ UW</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Applications/Videos/Forums/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ML+X</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Applications/Videos/ML4MI/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ML4MI</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Applications/Videos/SILO/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SILO</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Applications/Videos/Other/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Other</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Category glossary</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#part-1-factual-retrieval-demo-romeo-and-juliet" id="toc-part-1-factual-retrieval-demo-romeo-and-juliet" class="nav-link active" data-scroll-target="#part-1-factual-retrieval-demo-romeo-and-juliet">Part 1: Factual Retrieval Demo (Romeo and Juliet)</a>
  <ul class="collapse">
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link" data-scroll-target="#learning-objectives">Learning Objectives</a></li>
  <li><a href="#step-by-step-overview" id="toc-step-by-step-overview" class="nav-link" data-scroll-target="#step-by-step-overview">Step-by-Step Overview</a></li>
  <li><a href="#step-1-load-the-corpus" id="toc-step-1-load-the-corpus" class="nav-link" data-scroll-target="#step-1-load-the-corpus">Step 1: Load the corpus</a></li>
  <li><a href="#step-2-split-text-into-chunks" id="toc-step-2-split-text-into-chunks" class="nav-link" data-scroll-target="#step-2-split-text-into-chunks">Step 2: Split text into “chunks”</a></li>
  <li><a href="#step-3-embed-chunks-with-sentence-transformers" id="toc-step-3-embed-chunks-with-sentence-transformers" class="nav-link" data-scroll-target="#step-3-embed-chunks-with-sentence-transformers">Step 3: Embed Chunks with Sentence Transformers</a>
  <ul class="collapse">
  <li><a href="#why-embeddings-matter-in-rag" id="toc-why-embeddings-matter-in-rag" class="nav-link" data-scroll-target="#why-embeddings-matter-in-rag">Why embeddings matter in RAG</a></li>
  </ul></li>
  <li><a href="#step-4-retrieve-relevant-chunks" id="toc-step-4-retrieve-relevant-chunks" class="nav-link" data-scroll-target="#step-4-retrieve-relevant-chunks">Step 4: Retrieve Relevant Chunks</a>
  <ul class="collapse">
  <li><a href="#are-question-embeddings-and-chunk-embeddings-really-comparable" id="toc-are-question-embeddings-and-chunk-embeddings-really-comparable" class="nav-link" data-scroll-target="#are-question-embeddings-and-chunk-embeddings-really-comparable">Are question embeddings and chunk embeddings really comparable?</a></li>
  <li><a href="#summary-retrieval-results-for-factual-query" id="toc-summary-retrieval-results-for-factual-query" class="nav-link" data-scroll-target="#summary-retrieval-results-for-factual-query">Summary: Retrieval Results for Factual Query</a></li>
  <li><a href="#observations" id="toc-observations" class="nav-link" data-scroll-target="#observations">Observations</a></li>
  <li><a href="#run-a-few-additional-queries-report-top-ranked-chunk" id="toc-run-a-few-additional-queries-report-top-ranked-chunk" class="nav-link" data-scroll-target="#run-a-few-additional-queries-report-top-ranked-chunk">Run a few additional queries &amp; report top-ranked chunk</a></li>
  <li><a href="#improving-retrieved-chunks" id="toc-improving-retrieved-chunks" class="nav-link" data-scroll-target="#improving-retrieved-chunks">Improving Retrieved Chunks</a></li>
  <li><a href="#refining-chunking-strategy" id="toc-refining-chunking-strategy" class="nav-link" data-scroll-target="#refining-chunking-strategy">Refining chunking strategy</a></li>
  </ul></li>
  <li><a href="#takeaway" id="toc-takeaway" class="nav-link" data-scroll-target="#takeaway">Takeaway</a>
  <ul class="collapse">
  <li><a href="#what-is-reranking" id="toc-what-is-reranking" class="nav-link" data-scroll-target="#what-is-reranking">What is reranking?</a></li>
  </ul></li>
  <li><a href="#upgrading-our-retrieval-model" id="toc-upgrading-our-retrieval-model" class="nav-link" data-scroll-target="#upgrading-our-retrieval-model">Upgrading Our “Retrieval Model”</a></li>
  <li><a href="#step-5-ask-an-llm-using-retrieved-context" id="toc-step-5-ask-an-llm-using-retrieved-context" class="nav-link" data-scroll-target="#step-5-ask-an-llm-using-retrieved-context">Step 5: Ask an LLM using Retrieved Context</a>
  <ul class="collapse">
  <li><a href="#putting-it-all-together-answering-a-question-with-a-language-model" id="toc-putting-it-all-together-answering-a-question-with-a-language-model" class="nav-link" data-scroll-target="#putting-it-all-together-answering-a-question-with-a-language-model">Putting It All Together: Answering a Question with a Language Model</a></li>
  <li><a href="#language-model-for-generation" id="toc-language-model-for-generation" class="nav-link" data-scroll-target="#language-model-for-generation">Language Model for Generation</a></li>
  <li><a href="#why-the-model-output-includes-the-prompt" id="toc-why-the-model-output-includes-the-prompt" class="nav-link" data-scroll-target="#why-the-model-output-includes-the-prompt">Why the Model Output Includes the Prompt</a></li>
  <li><a href="#note-on-model-accuracy-and-hallucination" id="toc-note-on-model-accuracy-and-hallucination" class="nav-link" data-scroll-target="#note-on-model-accuracy-and-hallucination">Note on model accuracy and hallucination</a></li>
  <li><a href="#concluding-remarks" id="toc-concluding-remarks" class="nav-link" data-scroll-target="#concluding-remarks">Concluding Remarks</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.dev/UW-Madison-DataScience/ML-X-Nexus/blob/main/Learn/Notebooks/RAG-Romeo-Juliet.ipynb" class="toc-action"><i class="bi bi-github"></i>Improve this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<blockquote class="blockquote">
<p><strong>Note:</strong> This notebook was demoed at <a href="https://hub.datascience.wisc.edu/communities/mlx/#mlcoffee">ML+Coffee</a> on <strong>May 7, 2025</strong>.<br>
It’s an early work in progress, but I hope it’s useful in its current state!</p>
<p>We plan to integrate this tutorial into either our <a href="https://uw-madison-datascience.github.io/ML-X-Nexus/Learn/Workshops/Intro-TextAnalysis_Python.html">Intro to NLP workshop</a><br>
or into a new, dedicated workshop focused on RAG pipelines. Stay tuned — and subscribe to the <a href="https://groups.google.com/a/g-groups.wisc.edu/g/ml-community-of-practice">ML Community of Practice Google Group</a><br>
to stay informed about updates and new workshops.</p>
</blockquote>
<section id="part-1-factual-retrieval-demo-romeo-and-juliet" class="level1">
<h1>Part 1: Factual Retrieval Demo (Romeo and Juliet)</h1>
<p>This notebook demonstrates the use of a Retrieval-Augmented Generation (RAG) system to answer <strong>factual questions</strong> from Shakespeare’s <em>Romeo and Juliet</em>.</p>
<p>Our long-term goal is to build a RAG-powered chatbot that supports literary exploration—helping readers investigate character dynamics, thematic development, and emotional subtext.</p>
<p>In this first part of the demo, we focus on low-hanging fruit: factual, quote-supported questions that a RAG pipeline can answer reliably. These examples will help us introduce key RAG components, and set a performance baseline before tackling more interpretive questions.</p>
<section id="learning-objectives" class="level3">
<h3 class="anchored" data-anchor-id="learning-objectives">Learning Objectives</h3>
<p>By the end of this notebook, you should be able to:</p>
<ul>
<li>Identify the key components of a basic Retrieval-Augmented Generation (RAG) system.</li>
<li>Use a sentence-transformer model to create embeddings from text passages.</li>
<li>Run simple retrieval using vector similarity and evaluate retrieved chunks.</li>
<li>Generate answers to factual questions using retrieved content as context.</li>
<li>Understand early limitations of RAG pipelines and motivate future improvements.</li>
</ul>
</section>
<section id="step-by-step-overview" class="level3">
<h3 class="anchored" data-anchor-id="step-by-step-overview">Step-by-Step Overview</h3>
<ol type="1">
<li><strong>Load the Corpus</strong>
<ul>
<li>We use Shakespeare texts from the workshop’s <code>data.csv</code> file.</li>
</ul></li>
<li><strong>Split Text into Chunks</strong>
<ul>
<li>Long texts are broken into smaller passages (~200 words) so they’re easier to search and analyze.</li>
</ul></li>
<li><strong>Create Embeddings</strong>
<ul>
<li>Each chunk is converted into a vector — a mathematical representation of its meaning — using a pretrained model from <code>sentence-transformers</code>.</li>
</ul></li>
<li><strong>Retrieve Relevant Chunks</strong>
<ul>
<li>When you ask a question, we embed the question and compare it to the embedded text chunks to find the most similar passages.</li>
</ul></li>
<li><strong>Ask a Language Model</strong>
<ul>
<li>We take the most relevant passages and feed them (along with your question) into a pretrained language model (like GPT-2) to generate an answer.</li>
</ul></li>
</ol>
<p>This is not training a model from scratch — it’s a lightweight, modular way to build smart question-answering tools on top of your own text collection.</p>
<p>We’ll explore the strengths and limitations of this approach along the way.</p>
</section>
<section id="step-1-load-the-corpus" class="level2">
<h2 class="anchored" data-anchor-id="step-1-load-the-corpus">Step 1: Load the corpus</h2>
<p>In this example, we’ll use “Romeo and Juliet” as our text corpus. This text is freely available via <a href="https://uw-madison-datascience.github.io/ML-X-Nexus/Toolbox/Data/Gutenberg.html">Project Gutenberg</a>.</p>
<p>Preview the file</p>
<div id="bf16e1e1" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="5999da20-e88d-4702-8da4-dbb5e7be1442" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Download Romeo and Juliet from Project Gutenberg</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">'https://www.gutenberg.org/files/1112/1112-0.txt'</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> requests.get(url)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>file_contents <span class="op">=</span> response.text</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Preview first 3000 characters</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>preview_len <span class="op">=</span> <span class="dv">3000</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(file_contents[:preview_len])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>*** START OF THE PROJECT GUTENBERG EBOOK 1112 ***

The Tragedie of Romeo and Juliet

Actus Primus. Scoena Prima.

Enter Sampson and Gregory, with Swords and Bucklers, of the
House of
Capulet.

  Sampson. Gregory: A my word wee'l not carry coales

   Greg. No, for then we should be Colliars

   Samp. I mean, if we be in choller, wee'l draw

   Greg. I, While you liue, draw your necke out
o'th Collar

   Samp. I strike quickly, being mou'd

   Greg. But thou art not quickly mou'd to strike

   Samp. A dog of the house of Mountague, moues me

   Greg. To moue, is to stir: and to be valiant, is to stand:
Therefore, if thou art mou'd, thou runst away

   Samp. A dogge of that house shall moue me to stand.
I will take the wall of any Man or Maid of Mountagues

   Greg. That shewes thee a weake slaue, for the weakest
goes to the wall

   Samp. True, and therefore women being the weaker
Vessels, are euer thrust to the wall: therefore I will push
Mountagues men from the wall, and thrust his Maides to
the wall

   Greg. The Quarrell is betweene our Masters, and vs their men

   Samp. 'Tis all one, I will shew my selfe a tyrant: when
I haue fought with the men, I will bee ciuill with the
Maids, and cut off their heads

   Greg. The heads of the Maids?
  Sam. I, the heads of the Maids, or their Maiden-heads,
Take it in what sence thou wilt

   Greg. They must take it sence, that feele it

   Samp. Me they shall feele while I am able to stand:
And 'tis knowne I am a pretty peece of flesh

   Greg. 'Tis well thou art not Fish: If thou had'st, thou
had'st beene poore Iohn. Draw thy Toole, here comes of
the House of the Mountagues.
Enter two other Seruingmen.

  Sam. My naked weapon is out: quarrel, I wil back thee
  Gre. How? Turne thy backe, and run

   Sam. Feare me not

   Gre. No marry: I feare thee

   Sam. Let vs take the Law of our sides: let them begin

   Gr. I wil frown as I passe by, &amp; let the[m] take it as they list
  Sam. Nay, as they dare. I wil bite my Thumb at them,
which is a disgrace to them, if they beare it

   Abra. Do you bite your Thumbe at vs sir?
  Samp. I do bite my Thumbe, sir

   Abra. Do you bite your Thumb at vs, sir?
  Sam. Is the Law of our side, if I say I?
  Gre. No

   Sam. No sir, I do not bite my Thumbe at you sir: but
I bite my Thumbe sir

   Greg. Do you quarrell sir?
  Abra. Quarrell sir? no sir

   Sam. If you do sir, I am for you, I serue as good a man as you
  Abra. No better?
  Samp. Well sir.
Enter Benuolio.

  Gr. Say better: here comes one of my masters kinsmen

   Samp. Yes, better

   Abra. You Lye

   Samp. Draw if you be men. Gregory, remember thy
washing blow.

They Fight.

  Ben. Part Fooles, put vp your Swords, you know not
what you do.
Enter Tibalt.

  Tyb. What art thou drawne, among these heartlesse
Hindes? Turne thee Benuolio, looke vpon thy death

   Ben. I do but keepe the peace, put vp thy Sword</code></pre>
</div>
</div>
</section>
<section id="step-2-split-text-into-chunks" class="level2">
<h2 class="anchored" data-anchor-id="step-2-split-text-into-chunks">Step 2: Split text into “chunks”</h2>
<p>Next, we define a function to split the corpus into smaller chunks based on word count. The simplest “chunking” approach is to chunk by word count or character count.</p>
<div id="ed11f6c9" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> chunk_text(text, max_words<span class="op">=</span><span class="dv">200</span>):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> re  <span class="co"># Regular expressions will help us split the text more precisely</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use regex to tokenize the text:</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This pattern splits the text into:</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   - words (\w+)</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   - whitespace (\s+)</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   - punctuation or other non-whitespace symbols ([^\w\s])</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    words <span class="op">=</span> re.findall(<span class="vs">r'</span><span class="dv">\w</span><span class="op">+</span><span class="cf">|</span><span class="dv">\s</span><span class="op">+</span><span class="cf">|</span><span class="pp">[^</span><span class="dv">\w\s</span><span class="pp">]</span><span class="vs">'</span>, text)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    chunks <span class="op">=</span> []  <span class="co"># List to store the resulting text chunks</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    chunk <span class="op">=</span> []   <span class="co"># Temporary buffer to build up each chunk</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Iterate through each token (word, space, or punctuation)</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> word <span class="kw">in</span> words:</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        chunk.append(word)  <span class="co"># Add token to the current chunk</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(chunk) <span class="op">&gt;=</span> max_words:</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Once we reach the max word count, join tokens into a string and store the chunk</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>            chunks.append(<span class="st">""</span>.join(chunk))  <span class="co"># Use "".join() to preserve punctuation/spacing</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>            chunk <span class="op">=</span> []  <span class="co"># Reset for the next chunk</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If there's leftover content after the loop, add the final chunk</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> chunk:</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>        chunks.append(<span class="st">""</span>.join(chunk))</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chunks  <span class="co"># Return list of chunks</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then apply our chunking function to the corpus.</p>
<div id="OC1XBi0sDYUH" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="e2140437-d41d-4fd4-8a5e-d2c1f363eb4d" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the chunking function to your full text file</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>chunks <span class="op">=</span> chunk_text(file_contents, max_words<span class="op">=</span><span class="dv">200</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Show how many chunks were created</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Number of chunks: </span><span class="sc">{</span><span class="bu">len</span>(chunks)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Preview one of the chunks (by index)</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>chunk_ex_ind <span class="op">=</span> <span class="dv">1</span>  <span class="co"># Feel free to change this number to explore different parts of the text</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Chunk </span><span class="sc">{</span>chunk_ex_ind<span class="sc">}</span><span class="ss"> </span><span class="ch">\n</span><span class="sc">{</span>chunks[chunk_ex_ind]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of chunks: 283
Chunk 1 
strike

   Samp. A dog of the house of Mountague, moues me

   Greg. To moue, is to stir: and to be valiant, is to stand:
Therefore, if thou art mou'd, thou runst away

   Samp. A dogge of that house shall moue me to stand.
I will take the wall of any Man or Maid of Mountagues

   Greg. That shewes thee a weake slaue, for the weakest
goes to the wall

   Samp. True, and therefore women being the weaker
Vessels, are euer thrust to the wall: therefore I will push
Mountagues men from</code></pre>
</div>
</div>
</section>
<section id="step-3-embed-chunks-with-sentence-transformers" class="level2">
<h2 class="anchored" data-anchor-id="step-3-embed-chunks-with-sentence-transformers">Step 3: Embed Chunks with Sentence Transformers</h2>
<p>To enable semantic search, we need to convert our text chunks into numerical vectors—high-dimensional representations that capture meaning beyond simple keyword overlap. This process is called <em>embedding</em>, and it allows us to compare the semantic similarity between a user’s question and the contents of a document.</p>
<p>This is done using an <strong>encoder-only transformer model</strong>. Unlike decoder or encoder-decoder models, encoder-only models are not designed to generate text. Instead, they are optimized for understanding input sequences and producing meaningful vector representations. These models take in text and output fixed-size embeddings that capture semantic content—ideal for tasks like search, retrieval, and clustering.</p>
<p>We’ll use:</p>
<ul>
<li>The <a href="https://www.sbert.net/"><code>sentence-transformers</code></a> library
<ul>
<li>A widely used library that wraps encoder-only transformer models for generating sentence- and paragraph-level embeddings.</li>
<li>It provides a simple interface (<code>model.encode()</code>) and is optimized for performance and batching, making it well-suited for retrieval-augmented generation (RAG) workflows.</li>
<li>It supports both short queries and longer document chunks, embedding them into the same shared vector space.</li>
</ul></li>
<li>A pretrained model: <a href="https://huggingface.co/sentence-transformers/multi-qa-MiniLM-L6-cos-v1"><code>multi-qa-MiniLM-L6-cos-v1</code></a>
<ul>
<li>A compact encoder-only model (6 layers) designed for semantic search and question answering.</li>
<li>Trained using contrastive learning on query-passage pairs, so it learns to embed related questions and answers close together in vector space.</li>
<li>It’s efficient enough to run on CPUs or entry-level GPUs, making it great for experimentation and prototyping.</li>
</ul></li>
</ul>
<section id="why-embeddings-matter-in-rag" class="level3">
<h3 class="anchored" data-anchor-id="why-embeddings-matter-in-rag">Why embeddings matter in RAG</h3>
<p>In a RAG system, embeddings are the foundation for connecting a user’s question to the most relevant content in your corpus.</p>
<p>Rather than relying on exact keyword matches, embeddings represent both queries and document chunks in the same semantic space. When a user asks a question, we: 1. Convert the user’s question into a vector using the same encoder-only embedding model that was used to encode the document chunks. 2. Compute similarity scores (e.g., cosine similarity) between the query vector and each chunk vector. 3. Retrieve the top-matching chunks to pass along as context to the language model.</p>
<p>This allows the system to surface text that is meaningfully related to the question—even if it doesn’t use the same words.</p>
<p>For example, a question like “<em>What does Juliet think of Romeo?</em>” might retrieve a passage describing her inner turmoil or emotional reaction, even if the words “think” or “Romeo” aren’t explicitly present.</p>
<p>Embedding-based retrieval improves relevance, flexibility, and ultimately the quality of the answers your language model can generate.</p>
<div id="abaa5f1f" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="209b3654-923b-4f59-c0c6-59923e26f53d" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sentence_transformers <span class="im">import</span> SentenceTransformer</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>device <span class="op">=</span> <span class="st">'cuda'</span> <span class="cf">if</span> torch.cuda.is_available() <span class="cf">else</span> <span class="st">'cpu'</span> <span class="co"># make sure you have GPU enabled in colab to speed things up!</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'device=</span><span class="sc">{</span>device<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> SentenceTransformer(<span class="st">'multi-qa-MiniLM-L6-cos-v1'</span>, device<span class="op">=</span>device)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>embeddings <span class="op">=</span> model.encode(chunks, device<span class="op">=</span>device)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Shape of embedding matrix: </span><span class="sc">{</span>np<span class="sc">.</span>array(embeddings)<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>device=cuda</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/_auth.py:94: UserWarning: 
The secret `HF_TOKEN` does not exist in your Colab secrets.
To authenticate with the Hugging Face Hub, create a token in your settings tab (https://huggingface.co/settings/tokens), set it as secret in your Google Colab and restart your session.
You will be able to reuse this secret in all of your notebooks.
Please note that authentication is recommended but still optional to access public models or datasets.
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of embedding matrix: (283, 384)</code></pre>
</div>
</div>
<p><strong>Note</strong>: The shape of our embedding matrix is (283, 384) — representing the 283 chunks we prepared, and the 384 features describing each chunk. These are neural network derived features, lacking direct interpretability.</p>
</section>
</section>
<section id="step-4-retrieve-relevant-chunks" class="level2">
<h2 class="anchored" data-anchor-id="step-4-retrieve-relevant-chunks">Step 4: Retrieve Relevant Chunks</h2>
<p>In this step, we demonstrate a core component of a RAG (Retrieval-Augmented Generation) pipeline — finding the most relevant pieces of text to answer a user’s question. Here’s how it works:</p>
<ul>
<li>We take the user’s question and convert it into a vector embedding using the <em>same model</em> we used to embed the original text chunks.</li>
<li>Then we use cosine similarity to compare the question’s embedding to all text chunk embeddings.</li>
<li>We select the top <em>N</em> most similar chunks to use as context for the language model.</li>
</ul>
<section id="are-question-embeddings-and-chunk-embeddings-really-comparable" class="level3">
<h3 class="anchored" data-anchor-id="are-question-embeddings-and-chunk-embeddings-really-comparable">Are question embeddings and chunk embeddings really comparable?</h3>
<p>We’re assuming that the embedding model (e.g., <code>all-MiniLM-L6-v2</code>) was trained in such a way that <em>questions and answers occupy the same semantic space</em>. That is: - If a question and a passage are semantically aligned (e.g., about the same topic or fact), their embeddings should be close. - This assumption holds reasonably well for general-purpose models trained on sentence pairs. - But it’s not perfect — especially for very abstract or indirect questions. - If a model was only trained to embed statements, it may not align questions correctly. - You might retrieve chunks that are <strong>related but not directly useful</strong> for answering the question.</p>
<div id="95ac6038" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics.pairwise <span class="im">import</span> cosine_similarity</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> retrieve_relevant_chunks(model, query, chunks, embeddings, top_n<span class="op">=</span><span class="dv">3</span>):</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    query_embedding <span class="op">=</span> model.encode([query])</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    scores <span class="op">=</span> cosine_similarity(query_embedding, embeddings)[<span class="dv">0</span>]</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    top_indices <span class="op">=</span> scores.argsort()[<span class="op">-</span>top_n:][::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> [(chunks[i], scores[i]) <span class="cf">for</span> i <span class="kw">in</span> top_indices]</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="lcEo88GMGQx0" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="6e78a7e3-5837-43c3-e5b6-0ed0bd9442b5" data-execution_count="6">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>question <span class="op">=</span> <span class="st">"Who kills Mercutio?"</span> <span class="co"># Answer: Tybalt, Juliet's cousin</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>top_chunks <span class="op">=</span> retrieve_relevant_chunks(model, question, chunks, embeddings)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (chunk, score) <span class="kw">in</span> <span class="bu">enumerate</span>(top_chunks, <span class="dv">1</span>):</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n\n</span><span class="ss">############ CHUNK </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss"> ############"</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Score: </span><span class="sc">{</span>score<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(chunk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

############ CHUNK 1 ############
Score: 0.4241

Shalt with him hence

   Rom. This shall determine that.

They fight. Tybalt falles.

  Ben. Romeo, away be gone:
The Citizens are vp, and Tybalt slaine,
Stand not amaz'd, the Prince will Doome thee death
If thou art taken: hence, be gone, away

   Rom. O! I am Fortunes foole

   Ben. Why dost thou stay?

Exit Romeo.

Enter Citizens.

  Citi. Which way ran he that kild Mercutio?
  Tibalt that Murtherer, which way ran he?
  Ben. There lies that Tybalt

   Citi. Vp sir go with me:
I charge thee


############ CHUNK 2 ############
Score: 0.4075
on sudden hast

   Fri. Wisely and slow, they stumble that run fast.

Exeunt.

Enter Benuolio and Mercutio.

  Mer. Where the deule should this Romeo be? came he
not home to night?
  Ben. Not to his Fathers, I spoke with his man

   Mer. Why that same pale hard-harted wench, that Rosaline
torments him so, that he will sure run mad

   Ben. Tibalt, the kinsman to old Capulet, hath sent a Letter
to his Fathers house

   Mer. A challenge on my life

   Ben. Romeo will answere it

   Mer. Any man that can


############ CHUNK 3 ############
Score: 0.3821
Romeo Prince, he was Mercutios Friend,
His fault concludes, but what the law should end,
The life of Tybalt

   Prin. And for that offence,
Immediately we doe exile him hence:
I haue an interest in your hearts proceeding:
My bloud for your rude brawles doth lie a bleeding.
But Ile Amerce you with so strong a fine,
That you shall all repent the losse of mine.
It will be deafe to pleading and excuses,
Nor teares, nor prayers shall purchase our abuses.
Therefore vse none, let Romeo hence in hast,
Else when </code></pre>
</div>
</div>
</section>
<section id="summary-retrieval-results-for-factual-query" class="level3">
<h3 class="anchored" data-anchor-id="summary-retrieval-results-for-factual-query">Summary: Retrieval Results for Factual Query</h3>
<p>The following output shows how a RAG system handles the factual question “Who kills Mercutio?” using a chunked version of <em>Romeo and Juliet</em>. While no chunk explicitly states “Tybalt kills Mercutio” in modern phrasing, the system successfully retrieves highly relevant context. The Project Gutenberg edition uses the older spelling “Tibalt”, which the retriever still resolves semantically.</p>
<ul>
<li><strong>Chunk 1</strong> is the most direct and useful. It captures the aftermath of the duel, with citizens exclaiming:
<ul>
<li>“<em>Which way ran he that kild Mercutio? Tibalt that Murtherer, which way ran he?</em>”. Despite the archaic spelling and phrasing, this chunk effectively provides the answer when interpreted in context.</li>
</ul></li>
<li><strong>Chunk 2</strong> sets up the conflict. It includes Mercutio and Benvolio discussing that:
<ul>
<li>“<em>Tibalt, the kinsman to old Capulet, hath sent a Letter</em>” … “<em>A challenge on my life</em>”. While it doesn’t answer the question directly, it reinforces that Tibalt is the antagonist and establishes his role in escalating the violence.</li>
</ul></li>
<li><strong>Chunk 3</strong> presents the Prince’s legal judgment:
<ul>
<li>“<em>Romeo, Prince, he was Mercutios Friend… The life of Tibalt</em>.” The Prince confirms that Tybalt (Tibalt) has been killed in consequence of Mercutio’s death. This chunk emphasizes closure rather than causality, but still supports the factual chain.</li>
</ul></li>
</ul>
</section>
<section id="observations" class="level3">
<h3 class="anchored" data-anchor-id="observations">Observations</h3>
<ul>
<li>Early modern spelling (e.g., <em>Tibalt</em>) doesn’t hinder embedding-based retrieval — a strength of semantic models.</li>
<li>No chunk contains a complete “question + answer” sentence, but together they establish who killed whom, why, and what happened next.</li>
<li>The system retrieves scenes with narrative and legal resolution, not just the killing itself.</li>
</ul>
<p>This result demonstrates how chunk-level RAG with sentence-transformer embeddings can surface relevant evidence across spelling and stylistic variation, even when chunk boundaries split key action and dialogue.</p>
</section>
<section id="run-a-few-additional-queries-report-top-ranked-chunk" class="level3">
<h3 class="anchored" data-anchor-id="run-a-few-additional-queries-report-top-ranked-chunk">Run a few additional queries &amp; report top-ranked chunk</h3>
<div id="989a1a5d" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="5d53a429-19ec-4d41-f11d-bf7b55a4f543" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run a few factual queries and inspect the top-ranked chunks</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>factual_questions <span class="op">=</span> [</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Who kills Mercutio?"</span>, <span class="co"># Tybalt</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Where does Romeo meet Juliet?"</span>, <span class="co"># Capulet's masquerade ball (party), which takes place at the Capulet family home in Verona</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"What punishment does the Prince give Romeo?"</span> <span class="co"># exile / banishment</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> q <span class="kw">in</span> factual_questions:</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== Query: </span><span class="sc">{</span>q<span class="sc">}</span><span class="ss"> ==="</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> retrieve_relevant_chunks(model, q, chunks, embeddings, top_n<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, (chunk, score) <span class="kw">in</span> <span class="bu">enumerate</span>(results, <span class="dv">1</span>):</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">--- CHUNK </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss"> (Score: </span><span class="sc">{</span>score<span class="sc">:.4f}</span><span class="ss">) ---"</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(chunk[:<span class="dv">800</span>])  <span class="co"># print first ~800 chars for readability</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Query: Who kills Mercutio? ===

--- CHUNK 1 (Score: 0.4241) ---

Shalt with him hence

   Rom. This shall determine that.

They fight. Tybalt falles.

  Ben. Romeo, away be gone:
The Citizens are vp, and Tybalt slaine,
Stand not amaz'd, the Prince will Doome thee death
If thou art taken: hence, be gone, away

   Rom. O! I am Fortunes foole

   Ben. Why dost thou stay?

Exit Romeo.

Enter Citizens.

  Citi. Which way ran he that kild Mercutio?
  Tibalt that Murtherer, which way ran he?
  Ben. There lies that Tybalt

   Citi. Vp sir go with me:
I charge thee

=== Query: Where does Romeo meet Juliet? ===

--- CHUNK 1 (Score: 0.5812) ---
Romeo arise,
Thou wilt be taken, stay a while, stand vp:

Knocke.

Run to my study: by and by, Gods will
What simplenesse is this: I come, I come.

Knocke.

Who knocks so hard?
Whence come you? what's your will?
Enter Nurse.

  Nur. Let me come in,
And you shall know my errand:
I come from Lady Iuliet

   Fri. Welcome then

   Nur. O holy Frier, O tell me holy Frier,
Where's my Ladies Lord? where's Romeo?
  Fri. There on the ground,
With his owne 

=== Query: What punishment does the Prince give Romeo? ===

--- CHUNK 1 (Score: 0.7052) ---
Romeo Prince, he was Mercutios Friend,
His fault concludes, but what the law should end,
The life of Tybalt

   Prin. And for that offence,
Immediately we doe exile him hence:
I haue an interest in your hearts proceeding:
My bloud for your rude brawles doth lie a bleeding.
But Ile Amerce you with so strong a fine,
That you shall all repent the losse of mine.
It will be deafe to pleading and excuses,
Nor teares, nor prayers shall purchase our abuses.
Therefore vse none, let Romeo hence in hast,
Else when </code></pre>
</div>
</div>
</section>
<section id="improving-retrieved-chunks" class="level3">
<h3 class="anchored" data-anchor-id="improving-retrieved-chunks">Improving Retrieved Chunks</h3>
<p>Before we move on to having a language model generate answers, we need to take a closer look at the quality of the retrieved content.</p>
<p>As we just saw, our current retrieval method brings back passages that are topically related but often miss the actual moment where the answer appears. In some cases, the correct chunk is nearby but not retrieved. In others, key information may be split across multiple chunks or surrounded by distracting dialogue.</p>
<p>To address this, we’ll focus on a key area of improvement: <strong>refining the chunking strategy</strong>.</p>
<section id="why-chunking-matters" class="level4">
<h4 class="anchored" data-anchor-id="why-chunking-matters">Why chunking matters</h4>
<p>The current approach uses a simple method such as splitting the text by a fixed word count. While this works for general purposes, it often cuts across meaningful dramatic units: - A character’s speech may be interrupted mid-line - A fight scene may be split just before or after a critical action - A conversation between characters may be split across chunks</p>
<p>This leads to less coherent retrieval and lowers the chance that a single chunk can fully answer the question.</p>
<p>Here are two practical adjustments we can use to improve the retrievals:</p>
<ol type="1">
<li><p><strong>Group complete speaker turns into chunks</strong>: Instead of arbitrary lengths, we can group text based on who is speaking. This ensures each chunk preserves the flow and tone of the conversation.</p></li>
<li><p><strong>Use scene- or event-aware chunking</strong>: By chunking based on scene boundaries or key events (e.g.&nbsp;“Romeo kills Tybalt”), we improve the chance that retrieved content captures complete dramatic moments, not just pieces of them.</p></li>
</ol>
<p>These changes don’t require a new model—they just help the existing model work with more meaningful input.</p>
<p>Next, we’ll apply dialogue-aware chunking and rerun one of our earlier factual queries to see whether the results improve.</p>
</section>
</section>
<section id="refining-chunking-strategy" class="level3">
<h3 class="anchored" data-anchor-id="refining-chunking-strategy">Refining chunking strategy</h3>
<p>Our current chunks are only based on word length. Instead, we can create chunks that are more tuned to the dataset and potential questions we might ask by defining a chunk as a “dialogue block”, i.e., as a group of N full speaker turns (e.g., JULIET. + her lines, ROMEO. + his lines, etc.).</p>
<p>Let’s give this a shot to see how it impacts retrieval.</p>
<div id="Hi2C8LN_0ut0" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> chunk_by_speaker_blocks(text, block_size<span class="op">=</span><span class="dv">4</span>):</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This regex matches short speaker tags at the beginning of lines, e.g., "Ben." or "Rom."</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Followed by speech text (either same line or indented on next)</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    speaker_line_pattern <span class="op">=</span> re.<span class="bu">compile</span>(<span class="vs">r'</span><span class="dv">^\s</span><span class="op">{0,3}</span><span class="kw">(</span><span class="pp">[A-Z][a-z]</span><span class="op">+</span><span class="kw">)</span><span class="ch">\.</span><span class="dv">\s</span><span class="op">+</span><span class="kw">(</span><span class="dv">.</span><span class="op">*</span><span class="kw">)</span><span class="vs">'</span>, re.MULTILINE)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    dialogue_blocks <span class="op">=</span> []</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    current_speaker <span class="op">=</span> <span class="va">None</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    current_lines <span class="op">=</span> []</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> text.splitlines():</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>        match <span class="op">=</span> speaker_line_pattern.match(line)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> match:</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Save previous speaker block if one was accumulating</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> current_speaker:</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>                dialogue_blocks.append(<span class="ss">f"</span><span class="sc">{</span>current_speaker<span class="sc">}</span><span class="ss">.</span><span class="ch">\n</span><span class="ss">"</span> <span class="op">+</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(current_lines).strip())</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>            current_speaker <span class="op">=</span> match.group(<span class="dv">1</span>)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>            current_lines <span class="op">=</span> [match.group(<span class="dv">2</span>)]</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> current_speaker <span class="kw">and</span> line.strip():</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Indented continuation of the same speaker</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>            current_lines.append(line)</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Blank line or noise: treat as boundary</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> current_speaker <span class="kw">and</span> current_lines:</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>                dialogue_blocks.append(<span class="ss">f"</span><span class="sc">{</span>current_speaker<span class="sc">}</span><span class="ss">.</span><span class="ch">\n</span><span class="ss">"</span> <span class="op">+</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(current_lines).strip())</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>                current_speaker <span class="op">=</span> <span class="va">None</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>                current_lines <span class="op">=</span> []</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add last block if exists</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> current_speaker <span class="kw">and</span> current_lines:</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>        dialogue_blocks.append(<span class="ss">f"</span><span class="sc">{</span>current_speaker<span class="sc">}</span><span class="ss">.</span><span class="ch">\n</span><span class="ss">"</span> <span class="op">+</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(current_lines).strip())</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Chunk into groups of speaker turns</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>    grouped_chunks <span class="op">=</span> []</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(dialogue_blocks), block_size):</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>        chunk <span class="op">=</span> <span class="st">"</span><span class="ch">\n\n</span><span class="st">"</span>.join(dialogue_blocks[i:i <span class="op">+</span> block_size])</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>        grouped_chunks.append(chunk.strip())</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> grouped_chunks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="lrURRCYp092G" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="4c673158-a059-43a1-d4c0-bf4352bf3d55" data-execution_count="22">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>speaker_chunks <span class="op">=</span> chunk_by_speaker_blocks(file_contents, block_size<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total speaker_chunks: </span><span class="sc">{</span><span class="bu">len</span>(speaker_chunks)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Preview of first chunk:</span><span class="ch">\n\n</span><span class="sc">{</span>speaker_chunks[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total speaker_chunks: 205
Preview of first chunk:

Sampson.
Gregory: A my word wee'l not carry coales

Greg.
No, for then we should be Colliars

Samp.
I mean, if we be in choller, wee'l draw

Greg.
I, While you liue, draw your necke out
o'th Collar</code></pre>
</div>
</div>
<p>Our chunks have now been improved so that we aren’t cutting off any diagloue mid-sentence, and each chunk contains a few turns between speakers – allowing us to better capture the overall semantics of short passages from <em>Romeo and Juliet</em>.</p>
<div id="AGVFoQVG1HbN" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="e135569c-c17e-46da-d2b4-306ea82838e4" data-execution_count="23">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>dialogue_embeddings <span class="op">=</span> model.encode(speaker_chunks)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Shape of dialogue_embeddings matrix: </span><span class="sc">{</span>np<span class="sc">.</span>array(dialogue_embeddings)<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of dialogue_embeddings matrix: (205, 384)</code></pre>
</div>
</div>
<div id="UUWzN-OM4KT1" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="27ae4ea1-3937-435c-8085-94a1673d1f81" data-execution_count="24">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run a few factual queries and inspect the top-ranked chunks</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>factual_questions <span class="op">=</span> [</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Who kills Mercutio?"</span>, <span class="co"># Tybalt</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Where does Romeo meet Juliet?"</span>, <span class="co"># Capulet's masquerade ball (party), which takes place at the Capulet family home in Verona</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"What punishment does the Prince give Romeo?"</span> <span class="co"># exile / banishment</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> q <span class="kw">in</span> factual_questions:</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== Query: </span><span class="sc">{</span>q<span class="sc">}</span><span class="ss"> ==="</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> retrieve_relevant_chunks(model, q, speaker_chunks, dialogue_embeddings, top_n<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, (chunk, score) <span class="kw">in</span> <span class="bu">enumerate</span>(results, <span class="dv">1</span>):</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">--- CHUNK </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss"> (Score: </span><span class="sc">{</span>score<span class="sc">:.4f}</span><span class="ss">) ---"</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(chunk)  <span class="co"># print first ~800 chars for readability</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Query: Who kills Mercutio? ===

--- CHUNK 1 (Score: 0.5159) ---
Mer.
Come sir, your Passado

Rom.
Draw Benuolio, beat downe their weapons:
Gentlemen, for shame forbeare this outrage,
Tibalt, Mercutio, the Prince expresly hath
Forbidden bandying in Verona streetes.
Hold Tybalt, good Mercutio.

Mer.
I am hurt.
A plague a both the Houses, I am sped:
Is he gone and hath nothing?

Ben.
What art thou hurt?

=== Query: Where does Romeo meet Juliet? ===

--- CHUNK 1 (Score: 0.6061) ---
Watch.
Lead Boy, which way?

Iul.
Yea noise?
Then ile be briefe. O happy Dagger.
'Tis in thy sheath, there rust and let me die.

Boy.
This is the place,
There where the Torch doth burne

Watch.
The ground is bloody,
Search about the Churchyard.
Go some of you, who ere you find attach.
Pittifull sight, here lies the Countie slaine,
And Iuliet bleeding, warme and newly dead
Who here hath laine these two dayes buried.
Go tell the Prince, runne to the Capulets,
Raise vp the Mountagues, some others search,
We see the ground whereon these woes do lye,
But the true ground of all these piteous woes,
We cannot without circumstance descry.
Enter Romeo's man.

=== Query: What punishment does the Prince give Romeo? ===

--- CHUNK 1 (Score: 0.6221) ---
Prin.
Romeo slew him, he slew Mercutio,
Who now the price of his deare blood doth owe

Cap.
Not Romeo Prince, he was Mercutios Friend,
His fault concludes, but what the law should end,
The life of Tybalt

Prin.
And for that offence,
Immediately we doe exile him hence:
I haue an interest in your hearts proceeding:
My bloud for your rude brawles doth lie a bleeding.
But Ile Amerce you with so strong a fine,
That you shall all repent the losse of mine.
It will be deafe to pleading and excuses,
Nor teares, nor prayers shall purchase our abuses.
Therefore vse none, let Romeo hence in hast,
Else when he is found, that houre is his last.
Beare hence his body, and attend our will:
Mercy not Murders, pardoning those that kill.

Iul.
Gallop apace, you fiery footed steedes,
Towards Phoebus lodging, such a Wagoner
As Phaeton would whip you to the west,
And bring in Cloudie night immediately.
Spred thy close Curtaine Loue-performing night,
That run-awayes eyes may wincke, and Romeo
Leape to these armes, vntalkt of and vnseene,
Louers can see to doe their Amorous rights,
And by their owne Beauties: or if Loue be blind,
It best agrees with night: come ciuill night,
Thou sober suted Matron all in blacke,
And learne me how to loose a winning match,
Plaid for a paire of stainlesse Maidenhoods,
Hood my vnman'd blood bayting in my Cheekes,
With thy Blacke mantle, till strange Loue grow bold,
Thinke true Loue acted simple modestie:
Come night, come Romeo, come thou day in night,
For thou wilt lie vpon the wings of night
Whiter then new Snow vpon a Rauens backe:
Come gentle night, come louing blackebrow'd night.
Giue me my Romeo, and when I shall die,
Take him and cut him out in little starres,
And he will make the Face of heauen so fine,
That all the world will be in Loue with night,
And pay no worship to the Garish Sun.
O I haue bought the Mansion of a Loue,
But not possest it, and though I am sold,
Not yet enioy'd, so tedious is this day,
As is the night before some Festiuall,
To an impatient child that hath new robes
And may not weare them, O here comes my Nurse:
Enter Nurse with cords.</code></pre>
</div>
</div>
</section>
</section>
<section id="takeaway" class="level2">
<h2 class="anchored" data-anchor-id="takeaway">Takeaway</h2>
<p>Refining our chunking strategy to preserve full speaker turns—and grouping several turns together—has already improved the relevance of the chunks retrieved. The content is more coherent, more complete, and better aligned with the structure of a play. This shows how much retrieval quality depends not just on the model, but on the way we prepare and represent the source material.</p>
<p>That said, even with better chunks, retrieval doesn’t always land on the exact moment that answers the question. Sometimes it gets close but stops short; other times it picks up a scene with similar characters or themes, but not the one we need.</p>
<p>This points to a deeper challenge: <em>semantic similarity alone doesn’t always capture answer relevance</em>. The chunk that’s closest in meaning isn’t always the one that answers the question. One way to address this is through a process called <strong>reranking</strong>.</p>
<section id="what-is-reranking" class="level3">
<h3 class="anchored" data-anchor-id="what-is-reranking">What is reranking?</h3>
<p>Reranking means retrieving a small set of candidate chunks—say, the top 5—and then using an additional method to determine which of those is the best fit for the question.</p>
<p>That method could be: - A custom scoring function (e.g., based on keyword overlap, speaker identity, or chunk metadata), - Or—more powerfully—a <em>separate language model</em>.</p>
<p>This separate model can be small or large, depending on your resource availability: - A smaller open-source model (like <code>mistral</code>, <code>falcon</code>, or <code>phi</code>) can often handle basic ranking tasks at low cost. - A larger LLM (like GPT-3.5 or GPT-4) may be better at reasoning through subtleties and weighing relevance when answers are indirect or distributed across lines.</p>
<p>You might ask this model something like:</p>
<blockquote class="blockquote">
<p>Here are three passages. Which one best answers the question: “Who kills Mercutio?”</p>
</blockquote>
<p>At first, it might feel strange to use one language model to support another—but this layered setup is common in production RAG pipelines. It separates concerns: - The retriever quickly narrows down the universe of text, - The reranker evaluates those chunks more deeply, focusing on which is most likely to be useful.</p>
<p>We won’t implement this yet, but it’s worth introducing now. As we start exploring more ambiguous or emotionally driven questions in later sections, reranking becomes one of the key techniques for bridging the gap between retrieval and meaningful response.</p>
<p>For now, we’ve established a strong foundation: well-structured chunks that carry clear speaker information and preserve narrative flow. That’s a critical step toward building a RAG system that doesn’t just respond, but interprets.</p>
</section>
</section>
<section id="upgrading-our-retrieval-model" class="level2">
<h2 class="anchored" data-anchor-id="upgrading-our-retrieval-model">Upgrading Our “Retrieval Model”</h2>
<p>The model we’ve used so far, <a href="https://huggingface.co/sentence-transformers/multi-qa-MiniLM-L6-cos-v1"><code>multi-qa-MiniLM-L6-cos-v1</code></a>, is a solid starting point for retrieval-augmented generation (RAG) pipelines, it is relatively lightweight (22M parameters, ~500–800 MB GPU memory), which makes it efficient but less expressive than larger models.</p>
<p>However, larger embedding models have more capacity to capture subtle semantic relationships, including indirect phrasing or domain-specific language. This can make a dramatic difference in tasks like matching Shakespearean dialogue to modern questions—something smaller models often struggle with.</p>
<p>Let’s try a slightly larger model with 109 M parameters, <a href="https://huggingface.co/sentence-transformers/all-mpnet-base-v2"><code>all-mpnet-base-v2</code></a></p>
<div id="ICyc7zk0ZiTP" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sentence_transformers <span class="im">import</span> SentenceTransformer</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the dot-product version of the same model</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>model_larger <span class="op">=</span> SentenceTransformer(<span class="st">'all-mpnet-base-v2'</span>, device<span class="op">=</span>device) <span class="co"># larger model</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate embeddings for all chunks</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>dialogue_embeddings <span class="op">=</span> model_larger.encode(speaker_chunks,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>                                              device<span class="op">=</span>device,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>                                              convert_to_numpy<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>                                              normalize_embeddings<span class="op">=</span><span class="va">False</span>) <span class="co"># dot-product scoring expects unnormalized vectors.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="nUr5Q1MAaLbj" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="fc3b5fc4-8a48-43b4-afe6-f6b7abece865" data-execution_count="18">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run a few factual queries and inspect the top-ranked chunks</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>factual_questions <span class="op">=</span> [</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Who kills Mercutio?"</span>, <span class="co"># Tybalt</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Where does Romeo meet Juliet?"</span>, <span class="co"># Capulet's masquerade ball (party), which takes place at the Capulet family home in Verona</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"What punishment does the Prince give Romeo?"</span> <span class="co"># exile / banishment</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> q <span class="kw">in</span> factual_questions:</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== Query: </span><span class="sc">{</span>q<span class="sc">}</span><span class="ss"> ==="</span>)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> retrieve_relevant_chunks(model_larger, q, speaker_chunks, dialogue_embeddings, top_n<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, (chunk, score) <span class="kw">in</span> <span class="bu">enumerate</span>(results, <span class="dv">1</span>):</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">--- CHUNK </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss"> (Score: </span><span class="sc">{</span>score<span class="sc">:.4f}</span><span class="ss">) ---"</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(chunk)  <span class="co"># print first ~800 chars for readability</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Query: Who kills Mercutio? ===

--- CHUNK 1 (Score: 0.5408) ---
Mer.
Come sir, your Passado

Rom.
Draw Benuolio, beat downe their weapons:
Gentlemen, for shame forbeare this outrage,
Tibalt, Mercutio, the Prince expresly hath
Forbidden bandying in Verona streetes.
Hold Tybalt, good Mercutio.

Mer.
I am hurt.
A plague a both the Houses, I am sped:
Is he gone and hath nothing?

Ben.
What art thou hurt?

=== Query: Where does Romeo meet Juliet? ===

--- CHUNK 1 (Score: 0.6474) ---
Fri.
Romeo.
Alacke, alacke, what blood is this which staines
The stony entrance of this Sepulcher?
What meane these Masterlesse, and goarie Swords
To lie discolour'd by this place of peace?
Romeo, oh pale: who else? what Paris too?
And steept in blood? Ah what an vnkind houre
Is guiltie of this lamentable chance?
The Lady stirs

Iul.
O comfortable Frier, where's my Lord?
I do remember well where I should be:
And there I am, where is my Romeo?

Fri.
I heare some noyse Lady, come from that nest
Of death, contagion, and vnnaturall sleepe,
A greater power then we can contradict
Hath thwarted our entents, come, come away,
Thy husband in thy bosome there lies dead:
And Paris too: come Ile dispose of thee,
Among a Sisterhood of holy Nunnes:
Stay not to question, for the watch is comming.
Come, go good Iuliet, I dare no longer stay.
Enter.

Iul.
Go get thee hence, for I will not away,
What's here, A cup clos'd in my true loues hand?
Poyson I see hath bin his timelesse end
O churle, drinke all? and left no friendly drop,
To helpe me after, I will kisse thy lips,
Happlie some poyson yet doth hang on them,
To make me die with a restoratiue.
Thy lips are warme.
Enter Boy and Watch.

=== Query: What punishment does the Prince give Romeo? ===

--- CHUNK 1 (Score: 0.6811) ---
Prin.
Romeo slew him, he slew Mercutio,
Who now the price of his deare blood doth owe

Cap.
Not Romeo Prince, he was Mercutios Friend,
His fault concludes, but what the law should end,
The life of Tybalt

Prin.
And for that offence,
Immediately we doe exile him hence:
I haue an interest in your hearts proceeding:
My bloud for your rude brawles doth lie a bleeding.
But Ile Amerce you with so strong a fine,
That you shall all repent the losse of mine.
It will be deafe to pleading and excuses,
Nor teares, nor prayers shall purchase our abuses.
Therefore vse none, let Romeo hence in hast,
Else when he is found, that houre is his last.
Beare hence his body, and attend our will:
Mercy not Murders, pardoning those that kill.

Iul.
Gallop apace, you fiery footed steedes,
Towards Phoebus lodging, such a Wagoner
As Phaeton would whip you to the west,
And bring in Cloudie night immediately.
Spred thy close Curtaine Loue-performing night,
That run-awayes eyes may wincke, and Romeo
Leape to these armes, vntalkt of and vnseene,
Louers can see to doe their Amorous rights,
And by their owne Beauties: or if Loue be blind,
It best agrees with night: come ciuill night,
Thou sober suted Matron all in blacke,
And learne me how to loose a winning match,
Plaid for a paire of stainlesse Maidenhoods,
Hood my vnman'd blood bayting in my Cheekes,
With thy Blacke mantle, till strange Loue grow bold,
Thinke true Loue acted simple modestie:
Come night, come Romeo, come thou day in night,
For thou wilt lie vpon the wings of night
Whiter then new Snow vpon a Rauens backe:
Come gentle night, come louing blackebrow'd night.
Giue me my Romeo, and when I shall die,
Take him and cut him out in little starres,
And he will make the Face of heauen so fine,
That all the world will be in Loue with night,
And pay no worship to the Garish Sun.
O I haue bought the Mansion of a Loue,
But not possest it, and though I am sold,
Not yet enioy'd, so tedious is this day,
As is the night before some Festiuall,
To an impatient child that hath new robes
And may not weare them, O here comes my Nurse:
Enter Nurse with cords.</code></pre>
</div>
</div>
<p>If you’re interested in exploring more powerful options for RAG pipelines, consider:</p>
<ul>
<li><a href="https://huggingface.co/intfloat/e5-large-v2"><code>intfloat/e5-large-v2</code></a>: A 24‑layer encoder (335M params) fine-tuned for dense retrieval with <code>query:</code> / <code>passage:</code> formatting.</li>
<li><a href="https://huggingface.co/BAAI/bge-large-en-v1.5"><code>BAAI/bge-large-en-v1.5</code></a>: A high-performing English retriever (335M params) that tops MTEB benchmarks.</li>
<li><a href="https://huggingface.co/deepseek-ai/DeepSeek-V2"><code>deepseek-ai/DeepSeek-V2</code></a>: A large-scale mixture-of-experts model (236 B params) pioneering efficient retrieval architectures, but note it’s not a small encoder model—it’s listed here to showcase advanced retrieval methods.</li>
</ul>
<p>All of these are trained for dot-product similarity and work best with a high-performance index like <code>faiss.IndexFlatIP</code>.</p>
<p><strong>Note:</strong> We didn’t use FAISS in this notebook, since our dataset is small enough for brute-force similarity search. But once you move to larger models or bigger corpora, FAISS becomes essential for scalable and efficient retrieval.</p>
</section>
<section id="step-5-ask-an-llm-using-retrieved-context" class="level2">
<h2 class="anchored" data-anchor-id="step-5-ask-an-llm-using-retrieved-context">Step 5: Ask an LLM using Retrieved Context</h2>
<section id="putting-it-all-together-answering-a-question-with-a-language-model" class="level3">
<h3 class="anchored" data-anchor-id="putting-it-all-together-answering-a-question-with-a-language-model">Putting It All Together: Answering a Question with a Language Model</h3>
<p>Now that we’ve improved our chunking and retrieval process, we’re ready to pass the retrieved content to <em>yet another</em> language model and generate an answer.</p>
<p>This step completes the typical RAG (Retrieval-Augmented Generation) workflow: 1. Retrieve the top-ranked passage(s) using a retrieval LLM to embed the corpus into a Q&amp;A semantic space 2. Concatenate retrieved results them into a structured prompt 3. Ask a (generative) language model to answer the user’s question using only that retrieved context</p>
<p>This approach grounds the model’s answer in specific evidence from the text, making it more trustworthy than asking the model to “hallucinate” an answer from general pretraining.</p>
<section id="the-prompt-format" class="level4">
<h4 class="anchored" data-anchor-id="the-prompt-format">The Prompt Format</h4>
<p>We use a basic prompt like this:</p>
<pre><code>Passages: [Top retrieved chunk(s) go here]
Question: [your question]
Answer:</code></pre>
<p>By framing the input this way, we signal to the model that it should focus only on the retrieved content. We’re not asking it to draw from general knowledge of the play—just from the selected passages.</p>
<p>Let’s begin assembling the full prompt:</p>
<div id="nU_1xez_7H5L" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>question <span class="op">=</span> <span class="st">"Who killed Mercutio?"</span> <span class="co"># Tybalt/Tibalt</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="kwkSLZIE8xC1" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="c017fa7d-50e3-4c11-c1f0-3f7fbf9ae60e" data-execution_count="27">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>top_dialgoue_chunks <span class="op">=</span> retrieve_relevant_chunks(model_larger, question, speaker_chunks, dialogue_embeddings, top_n<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract only the chunk text from (chunk, score) tuples</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>context <span class="op">=</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(chunk <span class="cf">for</span> chunk, score <span class="kw">in</span> top_dialgoue_chunks)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(context)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mer.
Come sir, your Passado

Rom.
Draw Benuolio, beat downe their weapons:
Gentlemen, for shame forbeare this outrage,
Tibalt, Mercutio, the Prince expresly hath
Forbidden bandying in Verona streetes.
Hold Tybalt, good Mercutio.

Mer.
I am hurt.
A plague a both the Houses, I am sped:
Is he gone and hath nothing?

Ben.
What art thou hurt?
Ben.
Here comes the Furious Tybalt backe againe

Rom.
He gon in triumph, and Mercutio slaine?
Away to heauen respectiue Lenitie,
And fire and Fury, be my conduct now.
Now Tybalt take the Villaine backe againe
That late thou gau'st me, for Mercutios soule
Is but a little way aboue our heads,
Staying for thine to keepe him companie:
Either thou or I, or both, must goe with him

Tib.
Thou wretched Boy that didst consort him here,
Shalt with him hence

Rom.
This shall determine that.
Ben.
There lies that Tybalt

Citi.
Vp sir go with me:
I charge thee in the Princes names obey.
Enter Prince, old Montague, Capulet, their Wiues and all.

Prin.
Where are the vile beginners of this Fray?

Ben.
O Noble Prince, I can discouer all
The vnluckie Mannage of this fatall brall:
There lies the man slaine by young Romeo,
That slew thy kinsman braue Mercutio</code></pre>
</div>
</div>
<div id="F63kD70GQ87Z" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="e783032f-c954-480c-f7ab-e2d556806038" data-execution_count="28">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>prompt <span class="op">=</span> <span class="ss">f"Use the following passage to answer this question.</span><span class="ch">\n</span><span class="ss">BEGIN_PASSAGE:</span><span class="ch">\n</span><span class="sc">{</span>context<span class="sc">}</span><span class="ch">\n</span><span class="ss">END_PASSAGE</span><span class="ch">\n</span><span class="ss">QUESTION: </span><span class="sc">{</span>question<span class="sc">}</span><span class="ch">\n</span><span class="ss">ANSWER:"</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(prompt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Use the following passage to answer this question.
BEGIN_PASSAGE:
Mer.
Come sir, your Passado

Rom.
Draw Benuolio, beat downe their weapons:
Gentlemen, for shame forbeare this outrage,
Tibalt, Mercutio, the Prince expresly hath
Forbidden bandying in Verona streetes.
Hold Tybalt, good Mercutio.

Mer.
I am hurt.
A plague a both the Houses, I am sped:
Is he gone and hath nothing?

Ben.
What art thou hurt?
Ben.
Here comes the Furious Tybalt backe againe

Rom.
He gon in triumph, and Mercutio slaine?
Away to heauen respectiue Lenitie,
And fire and Fury, be my conduct now.
Now Tybalt take the Villaine backe againe
That late thou gau'st me, for Mercutios soule
Is but a little way aboue our heads,
Staying for thine to keepe him companie:
Either thou or I, or both, must goe with him

Tib.
Thou wretched Boy that didst consort him here,
Shalt with him hence

Rom.
This shall determine that.
Ben.
There lies that Tybalt

Citi.
Vp sir go with me:
I charge thee in the Princes names obey.
Enter Prince, old Montague, Capulet, their Wiues and all.

Prin.
Where are the vile beginners of this Fray?

Ben.
O Noble Prince, I can discouer all
The vnluckie Mannage of this fatall brall:
There lies the man slaine by young Romeo,
That slew thy kinsman braue Mercutio
END_PASSAGE
QUESTION: Who killed Mercutio?
ANSWER:</code></pre>
</div>
</div>
</section>
</section>
<section id="language-model-for-generation" class="level3">
<h3 class="anchored" data-anchor-id="language-model-for-generation">Language Model for Generation</h3>
<p>For this section, we’re using <a href="https://huggingface.co/tiiuae/falcon-rw-1b"><code>tiiuae/falcon-rw-1b</code></a>, a small 1.3B parameter decoder-only model trained on the RefinedWeb dataset. It’s designed for general-purpose text continuation, not for answering questions or following instructions.</p>
<p>This makes it a good baseline for testing how much a generative model can do with only retrieved context and minimal guidance. As we’ll see, its output often reflects surface-level patterns or recent tokens, rather than accurate reasoning grounded in the text.</p>
<div id="h_u8i2rr7NKs" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:322,&quot;referenced_widgets&quot;:[&quot;64fa3eb848ec4380b581092727c87dc4&quot;,&quot;57761a5fc199487a86dba8152262d1e2&quot;,&quot;e4010790e0844b4980e365abd7914c24&quot;,&quot;44b51f9baf5743ac871f23b7167c4e19&quot;,&quot;98ad5506beff47688e1ceaa9293d67d9&quot;,&quot;48e707071b3d41ba98cf39f9021eb7e5&quot;,&quot;541ea22acd7c4507aadbf54c337cc371&quot;,&quot;38ee1ad820ec4becbabd8e735efe4d03&quot;,&quot;616141aa3c0f47aa80640a923b4036d8&quot;,&quot;9a92a219181640329ca22f6e4534603c&quot;,&quot;610649cc370745239eabecf365f2a3cb&quot;,&quot;f8c5c42652d84e7798e4ed78bc6a0692&quot;,&quot;1b8035225ce2442f9aae96eea8a0bdbd&quot;,&quot;26628350a4674f409eb4bf1aa8617f64&quot;,&quot;b8d4160000644caf9c46c692b8142650&quot;,&quot;207db904c4a24c7e810a00c07af94376&quot;,&quot;616c2efd042c4a8aa45e42a6e122cdbe&quot;,&quot;c71e09f955824f0f9e8b3a609e22762b&quot;,&quot;38a9bafa267f47b88e4aa4ca1b493ca0&quot;,&quot;0d8142dbb54e4db3bf905dfdd7fc58ca&quot;,&quot;68bb3e47c3414bec84bfd4b958602235&quot;,&quot;d36a8b5d076c44999572a2bf96298715&quot;,&quot;27827895c169406db2222d7edaeabe37&quot;,&quot;ce684f466a27423b9e0199bbbf31b62d&quot;,&quot;fa71901d65594654846bbd3661504d9b&quot;,&quot;a9fb77de0bc546af8953671a4cd743d0&quot;,&quot;62734da171134e5895d202e66af3f9f3&quot;,&quot;6fcb714b60a14d2c87c6cf77cd9b4532&quot;,&quot;04cf82bdf8484576ba4ec29ce2ca5a96&quot;,&quot;56ff918a3e1d4b95a0e9fb4992e97700&quot;,&quot;2ba70ca851f5471eb8046c29c1289106&quot;,&quot;56b513f7da9849158b157ef3500e4686&quot;,&quot;1b4db868ffdc4c2ea10cfe807c429bfa&quot;,&quot;52310a94dfdb4109a05430de5e3924ef&quot;,&quot;dc9227dd28a1479ba585c299e207ae6b&quot;,&quot;de81ccc52e3c415aa02bf986a04f62da&quot;,&quot;a86b4ef026824200abb172fa532c460a&quot;,&quot;e28148f283c1478f861557bdcbafaecc&quot;,&quot;ffbe81bbd9554ad6a9de8322e4f1f0b4&quot;,&quot;6f97a06f8e5c4a31b428bd85a3aeb94d&quot;,&quot;1ba4907e3d8744279871dc0f92080cc5&quot;,&quot;0a75dda1eb104b538f1a870cc1445787&quot;,&quot;b4cc4a8948714d2f97cccdca696d2c89&quot;,&quot;59ac4e3a29434f55b069dcfd8ef1d4f9&quot;,&quot;a6507fed86d540c38fbd0d075b2ff5df&quot;,&quot;386036457ebb4983baa44e30bf97c4fb&quot;,&quot;c130ae142ff8495ab412bcc3f11e6fb1&quot;,&quot;20105877aefa4065acec5f9d18f759f7&quot;,&quot;7b9f45257bf2464e917c4652c1a7257f&quot;,&quot;135aca8d399b4c3b915ec6a168d8922e&quot;,&quot;c42581a6082a4e439a09719c61eaf943&quot;,&quot;0a76e4da59be4c02a83366394ee45b2f&quot;,&quot;05046c0a361b4b30a7c52e8d63123d5f&quot;,&quot;9041af1e6a5b47bf84e71a0efa7cd811&quot;,&quot;bb8b0ebf40a248f49f0ea75de1313244&quot;,&quot;b9434c56b5b84dd0bf114a30bdcdb252&quot;,&quot;84751e1fe0cd4a329dc096306ecb56bd&quot;,&quot;859b272e9274457c8e92d6a1dc4a21c7&quot;,&quot;c2258ec1b07a4977bb683bf5eb595ab4&quot;,&quot;79da75d74a2d40deb953663e7f19db9b&quot;,&quot;8931cee4d4e44e45ac80374df3a614d9&quot;,&quot;b8ac740c3d0840629bf755ee57094a9e&quot;,&quot;ef35046d4eb24a03be3cfd32acb94750&quot;,&quot;6b3b83ed7ab141e0bb633e7eed1aa56e&quot;,&quot;236326709b064e48a0e01863c6f06d26&quot;,&quot;19eaee9a885f4d45a21dd0d299e8fe59&quot;,&quot;62902d2647c4441ebbf1218d0759887a&quot;,&quot;1740336dfdf94dc6b9ba77393cf2b095&quot;,&quot;b2e25f288b6544b3b171e9dfc1dc69b6&quot;,&quot;46b9b08b6e29426b84c52e69d7c92edc&quot;,&quot;e297a4c7bf944096842f6993b90b95bc&quot;,&quot;030d9d92744c417ebc8fa3513c994402&quot;,&quot;ce5f6b424d29424398411249b065b297&quot;,&quot;1865be8e1f694ffcb838ab0559cbdca9&quot;,&quot;1ba831af712a4011a49b3c10c82f0e4b&quot;,&quot;e2b20815d5d94b12a90d34c03c78c3c3&quot;,&quot;b5d8791bd7f4481d9d25077a8c2dc243&quot;,&quot;379e80b0a80b4a658510353d95b5a17e&quot;,&quot;da6400f69bf94e48b393738dbfdc197b&quot;,&quot;d49cc1083e6a401b889eb28a8935c4c0&quot;,&quot;f627ffceaca841f5a7e921e2be28e2e5&quot;,&quot;2bea523107744601ba0089422ac2fc8a&quot;,&quot;55969af0e37f4cf3ac4f3fb87f20b444&quot;,&quot;5cfd15ba10de4ee8a3bb0ef96f1f6555&quot;,&quot;26b531717b7342c6aa299b1d88188581&quot;,&quot;b19bcab95632444098e1d818878780c0&quot;,&quot;3a726e85cb5f43e08d30e94d2e970593&quot;,&quot;e007ac41f0924f3f8525a876390d2098&quot;,&quot;8a700c79b0dd4aa085d582b7e654f000&quot;,&quot;2ea4ea37a06b46f8b7774cffb2e9b87f&quot;,&quot;5a460f6b18084b629d4d25dfac8df2ad&quot;,&quot;a71eb42a51bf4442a43e9de2e03f870a&quot;,&quot;774485c0309340a59ba5e6c5bfaf6d61&quot;,&quot;7c0bef3ec0c34e79b3ac1cdf9e86cec6&quot;,&quot;37c286779e8d4e6c8f19f03c1ece56f8&quot;,&quot;6f32a53912a14be6859c80208d760b0c&quot;,&quot;3ffbf2f9492b4cc491527b7958c57cde&quot;,&quot;36e83d27cddf4448b63c7ed4b020fa69&quot;,&quot;9618afbaee4b477a9ac271a077e194c6&quot;]}}" data-outputid="dad798f0-b2f8-4305-c36e-ec78f6ec6331" data-execution_count="29">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> transformers <span class="im">import</span> pipeline</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>llm <span class="op">=</span> pipeline(<span class="st">"text-generation"</span>, model<span class="op">=</span><span class="st">"tiiuae/falcon-rw-1b"</span>, device_map<span class="op">=</span><span class="st">"auto"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major":2,"version_minor":0,"model_id":"64fa3eb848ec4380b581092727c87dc4","quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major":2,"version_minor":0,"model_id":"f8c5c42652d84e7798e4ed78bc6a0692","quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major":2,"version_minor":0,"model_id":"27827895c169406db2222d7edaeabe37","quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major":2,"version_minor":0,"model_id":"52310a94dfdb4109a05430de5e3924ef","quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major":2,"version_minor":0,"model_id":"a6507fed86d540c38fbd0d075b2ff5df","quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major":2,"version_minor":0,"model_id":"b9434c56b5b84dd0bf114a30bdcdb252","quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major":2,"version_minor":0,"model_id":"62902d2647c4441ebbf1218d0759887a","quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major":2,"version_minor":0,"model_id":"379e80b0a80b4a658510353d95b5a17e","quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major":2,"version_minor":0,"model_id":"8a700c79b0dd4aa085d582b7e654f000","quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Device set to use cuda:0</code></pre>
</div>
</div>
<section id="model-parameters-and-generation-behavior" class="level4">
<h4 class="anchored" data-anchor-id="model-parameters-and-generation-behavior">Model Parameters and Generation Behavior</h4>
<p>When we call the language model, we specify parameters like: - <code>max_new_tokens</code>: Limits how much it can generate (e.g., 100 tokens) - <code>do_sample=True</code>: Enables creative variation rather than deterministic output. For the purposes of getting a reproducible result, we’ll set this to <code>False</code></p>
<p>These parameters influence not just length, but also how literal or speculative the answer might be. Sampling increases variety but can also introduce tangents or continuation artifacts.</p>
<div id="ctt5-_4A7QUe" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="8661d77d-73ae-4abd-e46f-20f46818f967" data-execution_count="30">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> llm(prompt, max_new_tokens<span class="op">=</span><span class="dv">10</span>, do_sample<span class="op">=</span><span class="va">False</span>)[<span class="dv">0</span>][<span class="st">"generated_text"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>The following generation flags are not valid and may be ignored: ['temperature']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.</code></pre>
</div>
</div>
<div id="AhNYfqoISLJO" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="248e63f8-1b34-4680-9100-80e75b441362" data-execution_count="31">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Use the following passage to answer this question.
BEGIN_PASSAGE:
Mer.
Come sir, your Passado

Rom.
Draw Benuolio, beat downe their weapons:
Gentlemen, for shame forbeare this outrage,
Tibalt, Mercutio, the Prince expresly hath
Forbidden bandying in Verona streetes.
Hold Tybalt, good Mercutio.

Mer.
I am hurt.
A plague a both the Houses, I am sped:
Is he gone and hath nothing?

Ben.
What art thou hurt?
Ben.
Here comes the Furious Tybalt backe againe

Rom.
He gon in triumph, and Mercutio slaine?
Away to heauen respectiue Lenitie,
And fire and Fury, be my conduct now.
Now Tybalt take the Villaine backe againe
That late thou gau'st me, for Mercutios soule
Is but a little way aboue our heads,
Staying for thine to keepe him companie:
Either thou or I, or both, must goe with him

Tib.
Thou wretched Boy that didst consort him here,
Shalt with him hence

Rom.
This shall determine that.
Ben.
There lies that Tybalt

Citi.
Vp sir go with me:
I charge thee in the Princes names obey.
Enter Prince, old Montague, Capulet, their Wiues and all.

Prin.
Where are the vile beginners of this Fray?

Ben.
O Noble Prince, I can discouer all
The vnluckie Mannage of this fatall brall:
There lies the man slaine by young Romeo,
That slew thy kinsman braue Mercutio
END_PASSAGE
QUESTION: Who killed Mercutio?
ANSWER: Romeo.
QUESTION: What is the meaning</code></pre>
</div>
</div>
</section>
</section>
<section id="why-the-model-output-includes-the-prompt" class="level3">
<h3 class="anchored" data-anchor-id="why-the-model-output-includes-the-prompt">Why the Model Output Includes the Prompt</h3>
<p>When using a decoder-only language model (like Falcon or GPT) with the Hugging Face <code>pipeline("text-generation")</code>, the output will include the entire input prompt followed by the model’s generated continuation.</p>
<p>This happens because decoder-only models are trained to predict the <em>next token given all previous tokens</em>, not to separate a prompt from a response. So when you pass in a prompt, the model simply continues generating text — it doesn’t know where “input” ends and “output” begins.</p>
<p>As a result, the <code>pipeline</code> will return a string that contains both:</p>
<pre><code>[prompt] + [generated text]</code></pre>
<p>If you’re only interested in the generated part (e.g., the model’s answer), you’ll need to remove the prompt manually after generation.</p>
<p>We can strip off the final answer / generated result with the next code cell.</p>
<div id="40Gwd2Za7htP" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="71e2a6fa-482b-43a6-fc88-9744d0f7f2f9" data-execution_count="32">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>generated_answer <span class="op">=</span> result[<span class="bu">len</span>(prompt):].strip()</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(generated_answer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Romeo.
QUESTION: What is the meaning</code></pre>
</div>
</div>
<section id="why-the-output-might-drift-or-repeat" class="level4">
<h4 class="anchored" data-anchor-id="why-the-output-might-drift-or-repeat">Why the Output Might Drift or Repeat</h4>
<p>Even though we ask just one question, you might see the model: - Answer multiple questions in a row - Invent follow-up questions and answers - Continue in a Q&amp;A or list format beyond what was asked</p>
<p>This usually happens when: - The passage is long or covers multiple narrative beats - The model detects a repeated pattern (e.g., “Question: … Answer: …”) and keeps going</p>
<p>For example, with a passage that includes both a fight and a romantic scene, the model might output:</p>
<p>Question: Who kills Mercutio? Answer: Romeo. Question: What does Juliet say about fate? Answer: She curses fortune.</p>
<p>Even though we only asked the first question.</p>
<p>To limit this behavior, you can: - Set a lower <code>max_new_tokens</code> - Add a <code>stop</code> sequence after the first answer (if supported) - Use a tighter or more explicit prompt style</p>
<div id="XD3tDGwfRQwa" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="7acf6b34-4a9e-4b29-ca6c-3547c3c6447c" data-execution_count="36">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> llm(prompt, max_new_tokens<span class="op">=</span><span class="dv">1</span>, do_sample<span class="op">=</span><span class="va">False</span>)[<span class="dv">0</span>][<span class="st">"generated_text"</span>] <span class="co"># adjust to inlcude max of 1 new tokens</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>generated_answer <span class="op">=</span> result[<span class="bu">len</span>(prompt):].strip()</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(generated_answer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>The following generation flags are not valid and may be ignored: ['temperature']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Romeo</code></pre>
</div>
</div>
</section>
</section>
<section id="note-on-model-accuracy-and-hallucination" class="level3">
<h3 class="anchored" data-anchor-id="note-on-model-accuracy-and-hallucination">Note on model accuracy and hallucination</h3>
<p>Smaller decoder-only models like <code>tiiuae/falcon-rw-1b</code> are fast and lightweight, but they can make factual errors, especially when summarizing events from structured texts like plays or historical records.</p>
<p>For example, when asked “Who killed Mercutio?”, the model incorrectly responded:</p>
<p>“Romeo killed Mercutio”</p>
<p>This is not correct. Mercutio is killed by Tybalt during a street duel. Romeo kills Tybalt afterward in retaliation.</p>
<p>Interestingly, the correct information was present in the top retrieved chunk, but the phrasing may have confused the model:</p>
<blockquote class="blockquote">
<p>Mer.<br>
I am hurt.<br>
A plague a both the Houses, I am sped:<br>
Is he gone and hath nothing?</p>
</blockquote>
<blockquote class="blockquote">
<p>Ben.<br>
What art thou hurt?</p>
</blockquote>
<blockquote class="blockquote">
<p>Prin.<br>
Romeo slew him, he slew Mercutio,<br>
Who now the price of his deare blood doth owe</p>
</blockquote>
<blockquote class="blockquote">
<p>Cap.<br>
Not Romeo Prince, he was Mercutio’s Friend,<br>
His fault concludes, but what the law should end,<br>
The life of Tybalt</p>
</blockquote>
<section id="instruction-tuning-improves-perfomance" class="level4">
<h4 class="anchored" data-anchor-id="instruction-tuning-improves-perfomance">Instruction tuning improves perfomance</h4>
<p>To improve factual accuracy in your RAG pipeline, it’s helpful to use an <strong>instruction-tuned</strong> model rather than a base language model. You’ve been using <code>falcon-rw-1b</code> (where “rw” stands for “Refined Web”), which is trained only to continue text — not to follow specific question-and-answer instructions. That’s why it often hallucinates factual events.</p>
<p>A lightweight upgrade is to instead use <code>tiiuae/Falcon3-1B-Instruct</code>, an instruction-tuned version of Falcon. It still runs on modest hardware but is trained to follow prompts and answer questions in a focused way.</p>
<div id="NV6szuiR_86F" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:226,&quot;referenced_widgets&quot;:[&quot;50250ce85c9148a79b36f68b4f41f281&quot;,&quot;dac3fcb823a242d0b1f8769ebac66174&quot;,&quot;0913984746cf4d93b3c805f3c4675240&quot;,&quot;b26088113d2d44fe9efca0588e2ae0c3&quot;,&quot;68fb7972ebd54a59a0c4cce0cda61618&quot;,&quot;b11920846f454710a57030d8c6de222e&quot;,&quot;db7b788059464333be41877c027e82b7&quot;,&quot;10d8c25c644b4a1abedeee99d501b059&quot;,&quot;9338b4187b0c417ab62f18391f9c5395&quot;,&quot;d36e8e1081c5432cbc0e2ea428fe0113&quot;,&quot;075484fbebcd4c1597b6e7360803f2d4&quot;,&quot;a3e6e93c2428414ca0ac305a1f07ac00&quot;,&quot;b119e5b610cf4757ae7d6ef30ecd746d&quot;,&quot;7171a479f533481880257f4ef225f372&quot;,&quot;216152ede9914f85a517ef71c63187ce&quot;,&quot;8410116b31384bf6a21dbb3026047d32&quot;,&quot;37e667391e0d4c7388ccae252e60ce37&quot;,&quot;2c18bc4d77e043308244d377437c7412&quot;,&quot;443d1847130a49b0afc41306369cdf36&quot;,&quot;25ed8147379841c69b24516a1288cf34&quot;,&quot;a19ab81b40884223bceec78ba473d919&quot;,&quot;bee98433a2754bf7a9aec9389fc53f9e&quot;,&quot;63ad2070c2ac4cf3be3c8bf70c29715e&quot;,&quot;5eb42d352f8d4c09bce12ba52c2e0a19&quot;,&quot;9bf39594d0694308997b687e789627b9&quot;,&quot;c5c6993de79c4d538b747736e216892a&quot;,&quot;d3c59b89e16a4e1a8f6650d20e7c5fca&quot;,&quot;00e7d9a995b242298518bc5ad0a19972&quot;,&quot;98f111be41014a3a8b4da7cdddcc661c&quot;,&quot;3c50540fbb714d89b5d4976ff7125a47&quot;,&quot;176c413363234711865e5b79d8d14940&quot;,&quot;1adc73610db94810bc58cd2bc8b885cc&quot;,&quot;e57cf42a5f3543d0aa1fe7fefad92fc4&quot;,&quot;8053247d84b14653ad198d799df654ff&quot;,&quot;5c85ea3ed85a4e599b7754b079b83f31&quot;,&quot;2a048f0fac06468eaf289d3ded594331&quot;,&quot;709e0f1f3f4d4a05a8b498529f380916&quot;,&quot;826f7782d92d430c8d9d337d9582e912&quot;,&quot;5673a4c0918642088de0f75de85d99ea&quot;,&quot;d4ed6d49c552445d9171e76d7027fd96&quot;,&quot;46e10639abbb42bcbcb5af2349b33e44&quot;,&quot;b0e30c843a5e460aab8c751dbaa0e25a&quot;,&quot;72ad22b999c846709f39aa576830d180&quot;,&quot;480316ef0b834f7a89613db602b5c4ef&quot;,&quot;1ed933b3dba3476eac585979b4c9cfbe&quot;,&quot;1591b5d738844503a9a7a5d2d5ed9cb7&quot;,&quot;f8edc61cff1e4519bfc6030489b169c6&quot;,&quot;477356dee2154284a6d1a589d9d9f9c6&quot;,&quot;4fdc80e087114faaa768f9029e7cd109&quot;,&quot;8abf9f70a9284230b5c913a20e4090b9&quot;,&quot;93e0d8e8f27d403b980459bf35b9bd1a&quot;,&quot;bc0346bcfaea40409afca1ec0b55c371&quot;,&quot;539eba75fcba46b48d4991ccbd4a7bc6&quot;,&quot;e8b33bacb122459db32525d1a5b3a9b5&quot;,&quot;c60d4077de7744728200205bca47f1b4&quot;,&quot;50497fdedb2a4462bd5094f3ae9b3d8d&quot;,&quot;d2fe9716655b46b9a47f128f3fe54ddb&quot;,&quot;72b236f0b86047c0810bca5916956529&quot;,&quot;20a2c21fa2a8464bbf03917d838a7262&quot;,&quot;da0a331fbf4b48ea9951e09578aa0576&quot;,&quot;d0c7587c73ee4b25aa834c40f8502795&quot;,&quot;877aeca46c4640908dc9bb959119db5c&quot;,&quot;c2357c034424404ebdedb158c54f4d9e&quot;,&quot;5a94939deefb4b15b51408ffa2184c38&quot;,&quot;34f930274ef4403ba82c701206ea941c&quot;,&quot;71fadf4898084a0e9d8f9dc88b7543c8&quot;]}}" data-outputid="949d2613-971c-46f6-ee45-029df5c9a03e" data-execution_count="37">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> transformers <span class="im">import</span> pipeline</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>llm <span class="op">=</span> pipeline(</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text-generation"</span>,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    model<span class="op">=</span><span class="st">"tiiuae/falcon3-1b-instruct"</span>,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    device_map<span class="op">=</span><span class="st">"auto"</span>,</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    torch_dtype<span class="op">=</span><span class="st">"auto"</span>,  <span class="co"># optional, helps with GPU memory</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major":2,"version_minor":0,"model_id":"50250ce85c9148a79b36f68b4f41f281","quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major":2,"version_minor":0,"model_id":"a3e6e93c2428414ca0ac305a1f07ac00","quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major":2,"version_minor":0,"model_id":"63ad2070c2ac4cf3be3c8bf70c29715e","quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major":2,"version_minor":0,"model_id":"8053247d84b14653ad198d799df654ff","quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major":2,"version_minor":0,"model_id":"1ed933b3dba3476eac585979b4c9cfbe","quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major":2,"version_minor":0,"model_id":"50497fdedb2a4462bd5094f3ae9b3d8d","quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Device set to use cuda:0</code></pre>
</div>
</div>
<div id="9al11Y5AADc_" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="d4256348-5c9b-4c86-9506-3161f6c7143a" data-execution_count="43">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: We use max_new_tokens=3 here because words like "Tybalt" may be split into multiple tokens (e.g., "Ty", "b", "alt").</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># It's often tricky to get exactly one word due to subword tokenization.</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> llm(prompt, max_new_tokens<span class="op">=</span><span class="dv">3</span>, do_sample<span class="op">=</span><span class="va">False</span>)[<span class="dv">0</span>][<span class="st">"generated_text"</span>]</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co"># extract answer from full result, as before</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>generated_answer <span class="op">=</span> result[<span class="bu">len</span>(prompt):].strip()</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(generated_answer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>The following generation flags are not valid and may be ignored: ['temperature']. Set `TRANSFORMERS_VERBOSITY=info` for more details.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Tybalt</code></pre>
</div>
</div>
<p>If all else fails, we can start to try larger models to handle the answer generation step. Other models you could substitute here depending on your resources include: - <code>mistralai/Mistral-7B-Instruct-v0.1</code> — for stronger instruction-following - <code>meta-llama/Meta-Llama-3-8B-Instruct</code> — for more fluent answers - <code>openai/gpt-3.5-turbo</code> — via API (not Hugging Face)</p>
<p>For most open-source models, using <code>transformers</code> + <code>pipeline()</code> allows easy swapping once your retrieval system is set up.</p>
<p>Keep in mind: - Larger models require more memory (ideally a 12–16GB GPU) - Instruction-tuned models typically follow prompts more reliably than base models - You may still need to post-process outputs to extract just the answer</p>
<p>If you’re working in Colab, consider using quantized models (e.g., via <code>bitsandbytes</code>) or calling the model via Hugging Face’s hosted Inference API.</p>
</section>
</section>
<section id="concluding-remarks" class="level3">
<h3 class="anchored" data-anchor-id="concluding-remarks">Concluding Remarks</h3>
<p>This notebook introduced a basic Retrieval-Augmented Generation (RAG) pipeline for factual question answering using <em>Romeo and Juliet</em>. The goal was to build a simple but functioning system and surface practical lessons about how to improve performance.</p>
<p><strong>For retrieval</strong>, we explored and discussed improvements such as: - Using stronger embedding models (e.g., upgrading from <code>MiniLM</code> to <code>all-mpnet-base-v2</code>). - Adopting a question-aligned chunking strategy, where chunks were grouped by speaker turns to better match the structure of expected queries. - Implementing cosine similarity retrieval, which better handles variation in chunk lengths and embedding magnitudes. - Briefly mentioning reranking as a next step, though not yet implemented.</p>
<p><strong>For generation</strong>, we found that: - Instruction-tuned language models yield more precise and context-sensitive answers. - Prompt formatting significantly affects the clarity and relevance of the generated output. - Post-processing may be necessary for trimming or cleaning model responses, especially in short-form QA tasks.</p>
<p>While larger models consistently improve both retrieval and generation, thoughtful design choices—such as aligning chunk structure to question types, using the right embedding normalization, and writing effective prompts—can yield substantial gains, even in smaller pipelines.</p>
<p>This notebook serves as a first step in a broader RAG workflow. Future notebooks will experiment with more flexible chunking, incorporate reranking, and test the system’s ability to handle interpretive or subjective questions.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script type="application/vnd.jupyter.widget-state+json">
{"64fa3eb848ec4380b581092727c87dc4":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_57761a5fc199487a86dba8152262d1e2","IPY_MODEL_e4010790e0844b4980e365abd7914c24","IPY_MODEL_44b51f9baf5743ac871f23b7167c4e19"],"layout":"IPY_MODEL_98ad5506beff47688e1ceaa9293d67d9"}},"57761a5fc199487a86dba8152262d1e2":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_48e707071b3d41ba98cf39f9021eb7e5","placeholder":"​","style":"IPY_MODEL_541ea22acd7c4507aadbf54c337cc371","value":"config.json: 100%"}},"e4010790e0844b4980e365abd7914c24":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_38ee1ad820ec4becbabd8e735efe4d03","max":1046,"min":0,"orientation":"horizontal","style":"IPY_MODEL_616141aa3c0f47aa80640a923b4036d8","value":1046}},"44b51f9baf5743ac871f23b7167c4e19":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_9a92a219181640329ca22f6e4534603c","placeholder":"​","style":"IPY_MODEL_610649cc370745239eabecf365f2a3cb","value":" 1.05k/1.05k [00:00&lt;00:00, 70.6kB/s]"}},"98ad5506beff47688e1ceaa9293d67d9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"48e707071b3d41ba98cf39f9021eb7e5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"541ea22acd7c4507aadbf54c337cc371":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"38ee1ad820ec4becbabd8e735efe4d03":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"616141aa3c0f47aa80640a923b4036d8":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"9a92a219181640329ca22f6e4534603c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"610649cc370745239eabecf365f2a3cb":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f8c5c42652d84e7798e4ed78bc6a0692":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_1b8035225ce2442f9aae96eea8a0bdbd","IPY_MODEL_26628350a4674f409eb4bf1aa8617f64","IPY_MODEL_b8d4160000644caf9c46c692b8142650"],"layout":"IPY_MODEL_207db904c4a24c7e810a00c07af94376"}},"1b8035225ce2442f9aae96eea8a0bdbd":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_616c2efd042c4a8aa45e42a6e122cdbe","placeholder":"​","style":"IPY_MODEL_c71e09f955824f0f9e8b3a609e22762b","value":"pytorch_model.bin: 100%"}},"26628350a4674f409eb4bf1aa8617f64":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_38a9bafa267f47b88e4aa4ca1b493ca0","max":2623348889,"min":0,"orientation":"horizontal","style":"IPY_MODEL_0d8142dbb54e4db3bf905dfdd7fc58ca","value":2623348889}},"b8d4160000644caf9c46c692b8142650":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_68bb3e47c3414bec84bfd4b958602235","placeholder":"​","style":"IPY_MODEL_d36a8b5d076c44999572a2bf96298715","value":" 2.62G/2.62G [00:14&lt;00:00, 96.4MB/s]"}},"207db904c4a24c7e810a00c07af94376":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"616c2efd042c4a8aa45e42a6e122cdbe":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c71e09f955824f0f9e8b3a609e22762b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"38a9bafa267f47b88e4aa4ca1b493ca0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0d8142dbb54e4db3bf905dfdd7fc58ca":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"68bb3e47c3414bec84bfd4b958602235":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d36a8b5d076c44999572a2bf96298715":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"27827895c169406db2222d7edaeabe37":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_ce684f466a27423b9e0199bbbf31b62d","IPY_MODEL_fa71901d65594654846bbd3661504d9b","IPY_MODEL_a9fb77de0bc546af8953671a4cd743d0"],"layout":"IPY_MODEL_62734da171134e5895d202e66af3f9f3"}},"ce684f466a27423b9e0199bbbf31b62d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6fcb714b60a14d2c87c6cf77cd9b4532","placeholder":"​","style":"IPY_MODEL_04cf82bdf8484576ba4ec29ce2ca5a96","value":"model.safetensors: 100%"}},"fa71901d65594654846bbd3661504d9b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_56ff918a3e1d4b95a0e9fb4992e97700","max":2623284688,"min":0,"orientation":"horizontal","style":"IPY_MODEL_2ba70ca851f5471eb8046c29c1289106","value":2623284688}},"a9fb77de0bc546af8953671a4cd743d0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_56b513f7da9849158b157ef3500e4686","placeholder":"​","style":"IPY_MODEL_1b4db868ffdc4c2ea10cfe807c429bfa","value":" 2.62G/2.62G [00:10&lt;00:00, 228MB/s]"}},"62734da171134e5895d202e66af3f9f3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6fcb714b60a14d2c87c6cf77cd9b4532":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"04cf82bdf8484576ba4ec29ce2ca5a96":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"56ff918a3e1d4b95a0e9fb4992e97700":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2ba70ca851f5471eb8046c29c1289106":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"56b513f7da9849158b157ef3500e4686":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1b4db868ffdc4c2ea10cfe807c429bfa":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"52310a94dfdb4109a05430de5e3924ef":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_dc9227dd28a1479ba585c299e207ae6b","IPY_MODEL_de81ccc52e3c415aa02bf986a04f62da","IPY_MODEL_a86b4ef026824200abb172fa532c460a"],"layout":"IPY_MODEL_e28148f283c1478f861557bdcbafaecc"}},"dc9227dd28a1479ba585c299e207ae6b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ffbe81bbd9554ad6a9de8322e4f1f0b4","placeholder":"​","style":"IPY_MODEL_6f97a06f8e5c4a31b428bd85a3aeb94d","value":"generation_config.json: 100%"}},"de81ccc52e3c415aa02bf986a04f62da":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_1ba4907e3d8744279871dc0f92080cc5","max":115,"min":0,"orientation":"horizontal","style":"IPY_MODEL_0a75dda1eb104b538f1a870cc1445787","value":115}},"a86b4ef026824200abb172fa532c460a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b4cc4a8948714d2f97cccdca696d2c89","placeholder":"​","style":"IPY_MODEL_59ac4e3a29434f55b069dcfd8ef1d4f9","value":" 115/115 [00:00&lt;00:00, 12.1kB/s]"}},"e28148f283c1478f861557bdcbafaecc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ffbe81bbd9554ad6a9de8322e4f1f0b4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6f97a06f8e5c4a31b428bd85a3aeb94d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"1ba4907e3d8744279871dc0f92080cc5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0a75dda1eb104b538f1a870cc1445787":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"b4cc4a8948714d2f97cccdca696d2c89":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"59ac4e3a29434f55b069dcfd8ef1d4f9":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a6507fed86d540c38fbd0d075b2ff5df":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_386036457ebb4983baa44e30bf97c4fb","IPY_MODEL_c130ae142ff8495ab412bcc3f11e6fb1","IPY_MODEL_20105877aefa4065acec5f9d18f759f7"],"layout":"IPY_MODEL_7b9f45257bf2464e917c4652c1a7257f"}},"386036457ebb4983baa44e30bf97c4fb":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_135aca8d399b4c3b915ec6a168d8922e","placeholder":"​","style":"IPY_MODEL_c42581a6082a4e439a09719c61eaf943","value":"tokenizer_config.json: 100%"}},"c130ae142ff8495ab412bcc3f11e6fb1":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_0a76e4da59be4c02a83366394ee45b2f","max":234,"min":0,"orientation":"horizontal","style":"IPY_MODEL_05046c0a361b4b30a7c52e8d63123d5f","value":234}},"20105877aefa4065acec5f9d18f759f7":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_9041af1e6a5b47bf84e71a0efa7cd811","placeholder":"​","style":"IPY_MODEL_bb8b0ebf40a248f49f0ea75de1313244","value":" 234/234 [00:00&lt;00:00, 15.9kB/s]"}},"7b9f45257bf2464e917c4652c1a7257f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"135aca8d399b4c3b915ec6a168d8922e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c42581a6082a4e439a09719c61eaf943":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0a76e4da59be4c02a83366394ee45b2f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"05046c0a361b4b30a7c52e8d63123d5f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"9041af1e6a5b47bf84e71a0efa7cd811":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bb8b0ebf40a248f49f0ea75de1313244":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b9434c56b5b84dd0bf114a30bdcdb252":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_84751e1fe0cd4a329dc096306ecb56bd","IPY_MODEL_859b272e9274457c8e92d6a1dc4a21c7","IPY_MODEL_c2258ec1b07a4977bb683bf5eb595ab4"],"layout":"IPY_MODEL_79da75d74a2d40deb953663e7f19db9b"}},"84751e1fe0cd4a329dc096306ecb56bd":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8931cee4d4e44e45ac80374df3a614d9","placeholder":"​","style":"IPY_MODEL_b8ac740c3d0840629bf755ee57094a9e","value":"vocab.json: 100%"}},"859b272e9274457c8e92d6a1dc4a21c7":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_ef35046d4eb24a03be3cfd32acb94750","max":798156,"min":0,"orientation":"horizontal","style":"IPY_MODEL_6b3b83ed7ab141e0bb633e7eed1aa56e","value":798156}},"c2258ec1b07a4977bb683bf5eb595ab4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_236326709b064e48a0e01863c6f06d26","placeholder":"​","style":"IPY_MODEL_19eaee9a885f4d45a21dd0d299e8fe59","value":" 798k/798k [00:00&lt;00:00, 3.46MB/s]"}},"79da75d74a2d40deb953663e7f19db9b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8931cee4d4e44e45ac80374df3a614d9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b8ac740c3d0840629bf755ee57094a9e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ef35046d4eb24a03be3cfd32acb94750":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6b3b83ed7ab141e0bb633e7eed1aa56e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"236326709b064e48a0e01863c6f06d26":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"19eaee9a885f4d45a21dd0d299e8fe59":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"62902d2647c4441ebbf1218d0759887a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_1740336dfdf94dc6b9ba77393cf2b095","IPY_MODEL_b2e25f288b6544b3b171e9dfc1dc69b6","IPY_MODEL_46b9b08b6e29426b84c52e69d7c92edc"],"layout":"IPY_MODEL_e297a4c7bf944096842f6993b90b95bc"}},"1740336dfdf94dc6b9ba77393cf2b095":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_030d9d92744c417ebc8fa3513c994402","placeholder":"​","style":"IPY_MODEL_ce5f6b424d29424398411249b065b297","value":"merges.txt: 100%"}},"b2e25f288b6544b3b171e9dfc1dc69b6":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_1865be8e1f694ffcb838ab0559cbdca9","max":456318,"min":0,"orientation":"horizontal","style":"IPY_MODEL_1ba831af712a4011a49b3c10c82f0e4b","value":456318}},"46b9b08b6e29426b84c52e69d7c92edc":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e2b20815d5d94b12a90d34c03c78c3c3","placeholder":"​","style":"IPY_MODEL_b5d8791bd7f4481d9d25077a8c2dc243","value":" 456k/456k [00:00&lt;00:00, 2.10MB/s]"}},"e297a4c7bf944096842f6993b90b95bc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"030d9d92744c417ebc8fa3513c994402":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ce5f6b424d29424398411249b065b297":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"1865be8e1f694ffcb838ab0559cbdca9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1ba831af712a4011a49b3c10c82f0e4b":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"e2b20815d5d94b12a90d34c03c78c3c3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b5d8791bd7f4481d9d25077a8c2dc243":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"379e80b0a80b4a658510353d95b5a17e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_da6400f69bf94e48b393738dbfdc197b","IPY_MODEL_d49cc1083e6a401b889eb28a8935c4c0","IPY_MODEL_f627ffceaca841f5a7e921e2be28e2e5"],"layout":"IPY_MODEL_2bea523107744601ba0089422ac2fc8a"}},"da6400f69bf94e48b393738dbfdc197b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_55969af0e37f4cf3ac4f3fb87f20b444","placeholder":"​","style":"IPY_MODEL_5cfd15ba10de4ee8a3bb0ef96f1f6555","value":"tokenizer.json: 100%"}},"d49cc1083e6a401b889eb28a8935c4c0":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_26b531717b7342c6aa299b1d88188581","max":2107653,"min":0,"orientation":"horizontal","style":"IPY_MODEL_b19bcab95632444098e1d818878780c0","value":2107653}},"f627ffceaca841f5a7e921e2be28e2e5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_3a726e85cb5f43e08d30e94d2e970593","placeholder":"​","style":"IPY_MODEL_e007ac41f0924f3f8525a876390d2098","value":" 2.11M/2.11M [00:00&lt;00:00, 9.59MB/s]"}},"2bea523107744601ba0089422ac2fc8a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"55969af0e37f4cf3ac4f3fb87f20b444":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5cfd15ba10de4ee8a3bb0ef96f1f6555":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"26b531717b7342c6aa299b1d88188581":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b19bcab95632444098e1d818878780c0":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"3a726e85cb5f43e08d30e94d2e970593":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e007ac41f0924f3f8525a876390d2098":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8a700c79b0dd4aa085d582b7e654f000":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_2ea4ea37a06b46f8b7774cffb2e9b87f","IPY_MODEL_5a460f6b18084b629d4d25dfac8df2ad","IPY_MODEL_a71eb42a51bf4442a43e9de2e03f870a"],"layout":"IPY_MODEL_774485c0309340a59ba5e6c5bfaf6d61"}},"2ea4ea37a06b46f8b7774cffb2e9b87f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_7c0bef3ec0c34e79b3ac1cdf9e86cec6","placeholder":"​","style":"IPY_MODEL_37c286779e8d4e6c8f19f03c1ece56f8","value":"special_tokens_map.json: 100%"}},"5a460f6b18084b629d4d25dfac8df2ad":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_6f32a53912a14be6859c80208d760b0c","max":99,"min":0,"orientation":"horizontal","style":"IPY_MODEL_3ffbf2f9492b4cc491527b7958c57cde","value":99}},"a71eb42a51bf4442a43e9de2e03f870a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_36e83d27cddf4448b63c7ed4b020fa69","placeholder":"​","style":"IPY_MODEL_9618afbaee4b477a9ac271a077e194c6","value":" 99.0/99.0 [00:00&lt;00:00, 9.89kB/s]"}},"774485c0309340a59ba5e6c5bfaf6d61":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7c0bef3ec0c34e79b3ac1cdf9e86cec6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"37c286779e8d4e6c8f19f03c1ece56f8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6f32a53912a14be6859c80208d760b0c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3ffbf2f9492b4cc491527b7958c57cde":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"36e83d27cddf4448b63c7ed4b020fa69":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9618afbaee4b477a9ac271a077e194c6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"50250ce85c9148a79b36f68b4f41f281":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_dac3fcb823a242d0b1f8769ebac66174","IPY_MODEL_0913984746cf4d93b3c805f3c4675240","IPY_MODEL_b26088113d2d44fe9efca0588e2ae0c3"],"layout":"IPY_MODEL_68fb7972ebd54a59a0c4cce0cda61618"}},"dac3fcb823a242d0b1f8769ebac66174":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b11920846f454710a57030d8c6de222e","placeholder":"​","style":"IPY_MODEL_db7b788059464333be41877c027e82b7","value":"config.json: 100%"}},"0913984746cf4d93b3c805f3c4675240":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_10d8c25c644b4a1abedeee99d501b059","max":656,"min":0,"orientation":"horizontal","style":"IPY_MODEL_9338b4187b0c417ab62f18391f9c5395","value":656}},"b26088113d2d44fe9efca0588e2ae0c3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d36e8e1081c5432cbc0e2ea428fe0113","placeholder":"​","style":"IPY_MODEL_075484fbebcd4c1597b6e7360803f2d4","value":" 656/656 [00:00&lt;00:00, 73.4kB/s]"}},"68fb7972ebd54a59a0c4cce0cda61618":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b11920846f454710a57030d8c6de222e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"db7b788059464333be41877c027e82b7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"10d8c25c644b4a1abedeee99d501b059":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9338b4187b0c417ab62f18391f9c5395":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"d36e8e1081c5432cbc0e2ea428fe0113":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"075484fbebcd4c1597b6e7360803f2d4":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a3e6e93c2428414ca0ac305a1f07ac00":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_b119e5b610cf4757ae7d6ef30ecd746d","IPY_MODEL_7171a479f533481880257f4ef225f372","IPY_MODEL_216152ede9914f85a517ef71c63187ce"],"layout":"IPY_MODEL_8410116b31384bf6a21dbb3026047d32"}},"b119e5b610cf4757ae7d6ef30ecd746d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_37e667391e0d4c7388ccae252e60ce37","placeholder":"​","style":"IPY_MODEL_2c18bc4d77e043308244d377437c7412","value":"model.safetensors: 100%"}},"7171a479f533481880257f4ef225f372":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_443d1847130a49b0afc41306369cdf36","max":3338836632,"min":0,"orientation":"horizontal","style":"IPY_MODEL_25ed8147379841c69b24516a1288cf34","value":3338836632}},"216152ede9914f85a517ef71c63187ce":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a19ab81b40884223bceec78ba473d919","placeholder":"​","style":"IPY_MODEL_bee98433a2754bf7a9aec9389fc53f9e","value":" 3.34G/3.34G [00:17&lt;00:00, 250MB/s]"}},"8410116b31384bf6a21dbb3026047d32":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"37e667391e0d4c7388ccae252e60ce37":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2c18bc4d77e043308244d377437c7412":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"443d1847130a49b0afc41306369cdf36":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"25ed8147379841c69b24516a1288cf34":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"a19ab81b40884223bceec78ba473d919":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bee98433a2754bf7a9aec9389fc53f9e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"63ad2070c2ac4cf3be3c8bf70c29715e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_5eb42d352f8d4c09bce12ba52c2e0a19","IPY_MODEL_9bf39594d0694308997b687e789627b9","IPY_MODEL_c5c6993de79c4d538b747736e216892a"],"layout":"IPY_MODEL_d3c59b89e16a4e1a8f6650d20e7c5fca"}},"5eb42d352f8d4c09bce12ba52c2e0a19":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_00e7d9a995b242298518bc5ad0a19972","placeholder":"​","style":"IPY_MODEL_98f111be41014a3a8b4da7cdddcc661c","value":"generation_config.json: 100%"}},"9bf39594d0694308997b687e789627b9":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_3c50540fbb714d89b5d4976ff7125a47","max":113,"min":0,"orientation":"horizontal","style":"IPY_MODEL_176c413363234711865e5b79d8d14940","value":113}},"c5c6993de79c4d538b747736e216892a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_1adc73610db94810bc58cd2bc8b885cc","placeholder":"​","style":"IPY_MODEL_e57cf42a5f3543d0aa1fe7fefad92fc4","value":" 113/113 [00:00&lt;00:00, 11.8kB/s]"}},"d3c59b89e16a4e1a8f6650d20e7c5fca":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"00e7d9a995b242298518bc5ad0a19972":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"98f111be41014a3a8b4da7cdddcc661c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3c50540fbb714d89b5d4976ff7125a47":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"176c413363234711865e5b79d8d14940":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"1adc73610db94810bc58cd2bc8b885cc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e57cf42a5f3543d0aa1fe7fefad92fc4":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8053247d84b14653ad198d799df654ff":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_5c85ea3ed85a4e599b7754b079b83f31","IPY_MODEL_2a048f0fac06468eaf289d3ded594331","IPY_MODEL_709e0f1f3f4d4a05a8b498529f380916"],"layout":"IPY_MODEL_826f7782d92d430c8d9d337d9582e912"}},"5c85ea3ed85a4e599b7754b079b83f31":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5673a4c0918642088de0f75de85d99ea","placeholder":"​","style":"IPY_MODEL_d4ed6d49c552445d9171e76d7027fd96","value":"tokenizer_config.json: 100%"}},"2a048f0fac06468eaf289d3ded594331":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_46e10639abbb42bcbcb5af2349b33e44","max":364623,"min":0,"orientation":"horizontal","style":"IPY_MODEL_b0e30c843a5e460aab8c751dbaa0e25a","value":364623}},"709e0f1f3f4d4a05a8b498529f380916":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_72ad22b999c846709f39aa576830d180","placeholder":"​","style":"IPY_MODEL_480316ef0b834f7a89613db602b5c4ef","value":" 365k/365k [00:00&lt;00:00, 855kB/s]"}},"826f7782d92d430c8d9d337d9582e912":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5673a4c0918642088de0f75de85d99ea":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d4ed6d49c552445d9171e76d7027fd96":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"46e10639abbb42bcbcb5af2349b33e44":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b0e30c843a5e460aab8c751dbaa0e25a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"72ad22b999c846709f39aa576830d180":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"480316ef0b834f7a89613db602b5c4ef":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"1ed933b3dba3476eac585979b4c9cfbe":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_1591b5d738844503a9a7a5d2d5ed9cb7","IPY_MODEL_f8edc61cff1e4519bfc6030489b169c6","IPY_MODEL_477356dee2154284a6d1a589d9d9f9c6"],"layout":"IPY_MODEL_4fdc80e087114faaa768f9029e7cd109"}},"1591b5d738844503a9a7a5d2d5ed9cb7":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8abf9f70a9284230b5c913a20e4090b9","placeholder":"​","style":"IPY_MODEL_93e0d8e8f27d403b980459bf35b9bd1a","value":"tokenizer.json: 100%"}},"f8edc61cff1e4519bfc6030489b169c6":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_bc0346bcfaea40409afca1ec0b55c371","max":9780754,"min":0,"orientation":"horizontal","style":"IPY_MODEL_539eba75fcba46b48d4991ccbd4a7bc6","value":9780754}},"477356dee2154284a6d1a589d9d9f9c6":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e8b33bacb122459db32525d1a5b3a9b5","placeholder":"​","style":"IPY_MODEL_c60d4077de7744728200205bca47f1b4","value":" 9.78M/9.78M [00:00&lt;00:00, 11.4MB/s]"}},"4fdc80e087114faaa768f9029e7cd109":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8abf9f70a9284230b5c913a20e4090b9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"93e0d8e8f27d403b980459bf35b9bd1a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"bc0346bcfaea40409afca1ec0b55c371":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"539eba75fcba46b48d4991ccbd4a7bc6":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"e8b33bacb122459db32525d1a5b3a9b5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c60d4077de7744728200205bca47f1b4":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"50497fdedb2a4462bd5094f3ae9b3d8d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_d2fe9716655b46b9a47f128f3fe54ddb","IPY_MODEL_72b236f0b86047c0810bca5916956529","IPY_MODEL_20a2c21fa2a8464bbf03917d838a7262"],"layout":"IPY_MODEL_da0a331fbf4b48ea9951e09578aa0576"}},"d2fe9716655b46b9a47f128f3fe54ddb":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d0c7587c73ee4b25aa834c40f8502795","placeholder":"​","style":"IPY_MODEL_877aeca46c4640908dc9bb959119db5c","value":"special_tokens_map.json: 100%"}},"72b236f0b86047c0810bca5916956529":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_c2357c034424404ebdedb158c54f4d9e","max":826,"min":0,"orientation":"horizontal","style":"IPY_MODEL_5a94939deefb4b15b51408ffa2184c38","value":826}},"20a2c21fa2a8464bbf03917d838a7262":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_34f930274ef4403ba82c701206ea941c","placeholder":"​","style":"IPY_MODEL_71fadf4898084a0e9d8f9dc88b7543c8","value":" 826/826 [00:00&lt;00:00, 103kB/s]"}},"da0a331fbf4b48ea9951e09578aa0576":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d0c7587c73ee4b25aa834c40f8502795":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"877aeca46c4640908dc9bb959119db5c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c2357c034424404ebdedb158c54f4d9e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5a94939deefb4b15b51408ffa2184c38":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"34f930274ef4403ba82c701206ea941c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"71fadf4898084a0e9d8f9dc88b7543c8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}
</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/UW-Madison-DataScience\.github\.io\/ML-X-Nexus\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.dev/UW-Madison-DataScience/ML-X-Nexus/blob/main/Learn/Notebooks/RAG-Romeo-Juliet.ipynb" class="toc-action"><i class="bi bi-github"></i>Improve this page</a></li></ul></div></div></div></footer></body></html>